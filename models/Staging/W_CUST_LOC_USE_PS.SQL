

select	
	
	SQ_CUSTLOC_USE.CUST_ACCOUNT_ID	   CUST_ACCNT_ID,
	TO_CHAR(SQ_CUSTLOC_USE.CUST_ACCT_SITE_ID)	   CUSTOMER_LOC_ID,
	TO_CHAR(SQ_CUSTLOC_USE.CUST_ACCT_SITE_ID)	   ACCT_SITE_ID,
	SQ_CUSTLOC_USE.SITE_USE_ID	   SITE_USE_ID,
	SQ_CUSTLOC_USE.SITE_USE_CODE	  SITE_USE_CODE,
	SQ_CUSTLOC_USE.TERRITORY_ID	    TERRITORY_ID,
	CASE 
	WHEN SQ_CUSTLOC_USE.STATUS='I' THEN 'N'
	ELSE 'Y'
END	   ACTIVE_FLG,
	TO_CHAR(SQ_CUSTLOC_USE.CREATED_BY)	  CREATED_BY_ID,
	TO_CHAR(SQ_CUSTLOC_USE.LAST_UPDATED_BY)	   CHANGED_BY_ID,
	SQ_CUSTLOC_USE.CREATION_DATE	   CREATED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE	   CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE1	  AUX1_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE2	   AUX2_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE3	   AUX3_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE4	  AUX4_CHANGED_ON_DT,
	TO_DATE(SUBSTR('1999-01-01 09:46:31',0,19),'YYYY-MM-DD HH24:MI:SS')  SRC_EFF_FROM_DT,
	TO_DATE(SUBSTR('3714-01-01 09:46:31',0,19),'YYYY-MM-DD HH24:MI:SS')  SRC_EFF_TO_DT,
	380 DATASOURCE_NUM_ID,
	SQ_CUSTLOC_USE.DELETE_FLG	   DELETE_FLG,
	TO_CHAR(SQ_CUSTLOC_USE.SITE_USE_ID)	   INTEGRATION_ID,
	SQ_CUSTLOC_USE.X_CUSTOM	   X_CUSTOM
from	
( /* Subselect from SDE_ORA_CustomerLocationUseStaging.W_CUST_LOC_USE_PS_SQ_CUSTLOC_USE
*/


select 
	 

	   
	   CSU.SITE_USE_ID SITE_USE_ID,
	
CSU.LAST_UPDATE_DATE
 LAST_UPDATE_DATE,
	CSU.LAST_UPDATED_BY LAST_UPDATED_BY,
	CSU.CREATION_DATE CREATION_DATE,
	CSU.CREATED_BY CREATED_BY,
	CA.CUST_ACCOUNT_ID CUST_ACCOUNT_ID,
	CSU.SITE_USE_CODE SITE_USE_CODE,
	L.LOCATION_ID LOCATION_ID,
	CSU.CUST_ACCT_SITE_ID CUST_ACCT_SITE_ID,
	PS.PARTY_SITE_ID PARTY_SITE_ID,
	CAS.LAST_UPDATE_DATE LAST_UPDATE_DATE1,
	CSU.STATUS STATUS,
	CSU.TERRITORY_ID TERRITORY_ID,
	PS.LAST_UPDATE_DATE LAST_UPDATE_DATE2,
	L.LAST_UPDATE_DATE LAST_UPDATE_DATE3,
	CA.LAST_UPDATE_DATE LAST_UPDATE_DATE4,
	'0' X_CUSTOM,
	
'N'
 DELETE_FLG
from	"PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCOUNTS"    CA INNER JOIN ("PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_LOCATIONS"    L INNER JOIN ("PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_PARTY_SITES"    PS INNER JOIN ("PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_SITE_USES_ALL"    CSU INNER JOIN "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCT_SITES_ALL"    CAS ON CSU.CUST_ACCT_SITE_ID=CAS.CUST_ACCT_SITE_ID) ON PS.PARTY_SITE_ID=CAS.PARTY_SITE_ID) ON L.LOCATION_ID=PS.LOCATION_ID) ON CA.CUST_ACCOUNT_ID=CAS.CUST_ACCOUNT_ID
where	(1=1)

And (


((EXISTS (SELECT 1 FROM
(SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
   "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCT_SITES_ALL" HZ_CUST_ACCT_SITES_ALL

      WHERE HZ_CUST_ACCT_SITES_ALL.LAST_UPDATE_DATE > TO_DATE(SUBSTR('2002-01-23 09:46:31',0,19),'YYYY-MM-DD HH24:MI:SS') 
      UNION
	  SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
     "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCT_SITES_ALL" HZ_CUST_ACCT_SITES_ALL
 INNER JOIN
        
    "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCOUNTS" HZ_CUST_ACCOUNTS

      ON HZ_CUST_ACCT_SITES_ALL.CUST_ACCOUNT_ID=HZ_CUST_ACCOUNTS.CUST_ACCOUNT_ID
      WHERE HZ_CUST_ACCOUNTS.LAST_UPDATE_DATE > TO_DATE(SUBSTR('2002-01-23 09:46:31',0,19),'YYYY-MM-DD HH24:MI:SS') 
	  UNION
	  SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
     "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCT_SITES_ALL" HZ_CUST_ACCT_SITES_ALL
 INNER JOIN
        
     "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_SITE_USES_ALL" HZ_CUST_SITE_USES_ALL

      ON HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID=HZ_CUST_SITE_USES_ALL.CUST_ACCT_SITE_ID
      WHERE HZ_CUST_SITE_USES_ALL.LAST_UPDATE_DATE > TO_DATE(SUBSTR('2002-01-23 09:46:31',0,19),'YYYY-MM-DD HH24:MI:SS') 
	  UNION
      SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
    "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCT_SITES_ALL" HZ_CUST_ACCT_SITES_ALL
 INNER JOIN
        
     "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_PARTY_SITES" HZ_PARTY_SITES

      ON HZ_CUST_ACCT_SITES_ALL.PARTY_SITE_ID=HZ_PARTY_SITES.PARTY_SITE_ID
      WHERE HZ_PARTY_SITES.LAST_UPDATE_DATE > TO_DATE(SUBSTR('2002-01-23 09:46:31',0,19),'YYYY-MM-DD HH24:MI:SS') 
      UNION
      SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM (
      "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_CUST_ACCT_SITES_ALL" HZ_CUST_ACCT_SITES_ALL

  INNER JOIN (
     "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_PARTY_SITES" HZ_PARTY_SITES
 INNER JOIN 
    "PC_FIVETRAN_DB"."ERPPRD1_AR"."HZ_LOCATIONS" HZ_LOCATIONS

  ON HZ_PARTY_SITES.LOCATION_ID          =HZ_LOCATIONS.LOCATION_ID)
  ON HZ_CUST_ACCT_SITES_ALL.PARTY_SITE_ID=HZ_PARTY_SITES.PARTY_SITE_ID)
      WHERE HZ_LOCATIONS.LAST_UPDATE_DATE > TO_DATE(SUBSTR('2002-01-23 09:46:31',0,19),'YYYY-MM-DD HH24:MI:SS') 
	  ) TEMP 
WHERE  CAS.CUST_ACCT_SITE_ID=TEMP.CUST_ACCT_SITE_ID )))


)







)   SQ_CUSTLOC_USE
where	(1=1)






 

