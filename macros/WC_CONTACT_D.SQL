{% macro WC_CONTACT_D() %}
--To Do -- Clean up added records that are no longer needed

  {% set sql %}
  
  --Truncate table 

truncate table OBIEE_DW.WC_CONTACT_D;


  --Inserts records that don't have actuals for a given day, but have a daily budget
    insert into OBIEE_DW.WC_CONTACT_D
(
CONTACT_ID,
	CUSTOMER_ID,
	ADDRESS_ID,
	LAST_UPDATE_DATE,
	OBJECT_VERSION,
	LAST_UPDATED_BY,
	CREATION_DATE,
	CREATED_BY,
	LAST_UPDATE_LOGIN,
	FIRST_NAME,
	LAST_NAME,
	STATUS,
	MAIL_STOP,
	ORIG_SYSTEM_REFERENCE,
	CONTACT_KEY,
	EMAIL_ADDRESS,
	CONTACT_PARTY_ID,
	ORG_CONTACT_ID,
	CONTACT_NUMBER,
	CONT_POINT_OBJECT_VERSION,
	PARTY_LAST_UPDATE_DATE,
	PARTY_OBJECT_VERSION,
	REL_LAST_UPDATE_DATE,
	ORG_CONT_LAST_UPDATE_DATE,
	ORG_CONT_OBJECT_VERSION,
	PARTY_RELATIONSHIP_ID,
	REL_PARTY_LAST_UPDATE_DATE,
	REL_PARTY_OBJECT_VERSION,
	REL_PARTY_ID,
	RELATION_OBJECT_VERSION,
	INTEGRATION_ID,
	PHONE_NUMBER	
)
select 
 CONTACT_ID,
	CUSTOMER_ID,
	ADDRESS_ID,
	LAST_UPDATE_DATE,
	OBJECT_VERSION,
	LAST_UPDATED_BY,
	CREATION_DATE,
	CREATED_BY,
	LAST_UPDATE_LOGIN,
	FIRST_NAME,
	LAST_NAME,
	STATUS,
	MAIL_STOP,
	ORIG_SYSTEM_REFERENCE,
	CONTACT_KEY,
	EMAIL_ADDRESS,
	CONTACT_PARTY_ID,
	ORG_CONTACT_ID,
	CONTACT_NUMBER,
	CONT_POINT_OBJECT_VERSION,
	PARTY_LAST_UPDATE_DATE,
	PARTY_OBJECT_VERSION,
	REL_LAST_UPDATE_DATE,
	ORG_CONT_LAST_UPDATE_DATE,
	ORG_CONT_OBJECT_VERSION,
	PARTY_RELATIONSHIP_ID,
	REL_PARTY_LAST_UPDATE_DATE,
	REL_PARTY_OBJECT_VERSION,
	REL_PARTY_ID,
	RELATION_OBJECT_VERSION,
	INTEGRATION_ID,
	PHONE_NUMBER
from  OBIEE_DW.WC_CONTACT_DS;

{% endset %}

{% do run_query(sql) %}

{% do log("WC_CONTACT_D", info=True) %}

{% endmacro %}