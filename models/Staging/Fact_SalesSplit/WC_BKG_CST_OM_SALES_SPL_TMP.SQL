{{ config (
    materialized="table"
)}}

WITH WC_BKG_CST_OM_SALES_SPL_TMP AS
(
   
select	
	
	STAGING.ORDER_LINE_ID	    LINE_ID,
	STAGING.ORIG_SALESPERSON_ID	  ORIG_SALESREP_ID,
	STAGING.SPLIT_SALESPERSON_ID	   SPLIT_SALESREP_ID,
	STAGING.ORIG_SALESFORCE_ACCOUNT_ID	  ORIG_SF_ACCOUNT_ID,
	STAGING.SPLIT_SALESFORCE_ACCOUNT_ID	   SPLIT_SF_ACCOUNT_ID,
	STAGING.SALES_SPLIT_PERCENTAGE	   SPLIT_PERCENTAGE,
	STAGING.ORDERED_DATE	   ORDERED_DATE,
	STAGING.TRANSACTION_TYPE	   TRANSACTION_TYPE,
	SALESPERSON_LOOKUP.SOURCE_ID	   PERSON_ID
from	(

select 	
	RA_SALESREPS_ALL.SALESREP_ID    SALESREP_ID,	JTF_RS_RESOURCE_EXTNS.SOURCE_ID    SOURCE_ID
from	"PC_FIVETRAN_DB"."ERPPRD1_JTF"."JTF_RS_SALESREPS"  RA_SALESREPS_ALL, 
  "PC_FIVETRAN_DB"."ERPPRD1_JTF"."JTF_RS_RESOURCE_EXTNS" JTF_RS_RESOURCE_EXTNS
where	(1=1)
 And (RA_SALESREPS_ALL.RESOURCE_ID=JTF_RS_RESOURCE_EXTNS.RESOURCE_ID)
And (JTF_RS_RESOURCE_EXTNS.CATEGORY IN ('EMPLOYEE', 'OTHER'))


)   SALESPERSON_LOOKUP, 
( /* Subselect from WR_SDE_ORA_SalesSplitTempTables.WC_BKG_CST_OM_SALES_SPL_TMP_EXTRACT
*/


select 
	   

	   
	   WRS_SALES_ORDER_SPLIT_ALL.ORDER_LINE_ID ORDER_LINE_ID,
	WRS_SALES_ORDER_SPLIT_ALL.ORIG_SALESPERSON_ID ORIG_SALESPERSON_ID,
	WRS_SALES_ORDER_SPLIT_ALL.SPLIT_SALESPERSON_ID SPLIT_SALESPERSON_ID,
	WRS_SALES_ORDER_SPLIT_ALL.ORIG_SALESFORCE_ACCOUNT_ID ORIG_SALESFORCE_ACCOUNT_ID,
	WRS_SALES_ORDER_SPLIT_ALL.SPLIT_SALESFORCE_ACCOUNT_ID SPLIT_SALESFORCE_ACCOUNT_ID,
	WRS_SALES_ORDER_SPLIT_ALL.SALES_SPLIT_PERCENTAGE SALES_SPLIT_PERCENTAGE,
	OE_ORDER_HEADERS_ALL.ORDERED_DATE ORDERED_DATE,
	WRS_SALES_ORDER_SPLIT_ALL.TRANSACTION_TYPE TRANSACTION_TYPE
from	"PC_FIVETRAN_DB"."ERPPRD1_ONT"."OE_ORDER_HEADERS_ALL"   OE_ORDER_HEADERS_ALL, 
  "PC_FIVETRAN_DB"."ERPPRD1_WRSAPP"."WRS_SALES_ORDER_SPLIT_ALL"   WRS_SALES_ORDER_SPLIT_ALL
where	(1=1)
 And (OE_ORDER_HEADERS_ALL.HEADER_ID=WRS_SALES_ORDER_SPLIT_ALL.ORDER_HEADER_ID)








)   STAGING
where	(1=1)

 And (STAGING.SPLIT_SALESPERSON_ID=SALESPERSON_LOOKUP.SALESREP_ID)
)
SELECT * FROM WC_BKG_CST_OM_SALES_SPL_TMP