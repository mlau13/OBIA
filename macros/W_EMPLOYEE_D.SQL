{% macro W_EMPLOYEE_D() %}
--To Do -- Clean up added records that are no longer needed

  {% set sql %}
  
  --Delete inserted records

truncate table  OBIEE_DW.W_EMPLOYEE_D;


  --Inserts records that don't have actuals for a given day, but have a daily budget
    insert into OBIEE_DW.W_EMPLOYEE_D
(
FST_NAME	,
MID_NAME	,
LAST_NAME	,
PREV_LAST_NAME	,
FULL_NAME	,
NAME_PREFIX	,
INDV_TITLE	,
NAME_SUFFIX	,
PARTY_ID	,
EMAIL_ADDR	,
EMP_HIRE_DT	,
ORIG_HIRE_DT	,
ADJ_SERVICE_DT	,
CONTRACT_ST_DT	,
CONTRACT_END_DT	,
EMPLOYEE_NUM	,
SUPERVISOR_NUM	,
SUPERVISOR_NAME	,
CONTINGENT_WORKER_NUM	,
APPLICANT_NUM	,
DEPARTMENT_CODE	,
C22_HELD_POSTN	,
POSITION_TYPE_CODE	,
JOB_TITLE	,
PAR_HELD_POSTN	,
PR_POSTN	,
EMP_FLG	,
SALES_REP_FLG	,
BUYER_FLG	,
REQUESTOR_FLG	,
APPLICANT_FLG	,
MANAGER_FLG	,
LOGIN	,
SRC_EFF_FROM_DT	,
SRC_EFF_TO_DT	,
INTEGRATION_ID	,
X_CUSTOM	,
DELETE_FLG	,
PAR_INTEGRATION_ID	,
VIS_PR_BU_ID	,
VIS_PR_POS_ID	,
CREATED_BY_ID	,
CHANGED_BY_ID	,
CREATED_ON_DT	,
CHANGED_ON_DT	,
AUX1_CHANGED_ON_DT	,
AUX2_CHANGED_ON_DT	,
AUX3_CHANGED_ON_DT	,
LAST_WORKED_DT	,
REQUESTOR_ID	,
BUYER_ID	,
AUX6_CHANGED_ON_DT	,
X_SALESREP_NUMBER	,
PERSON_ID	,
SOURCE_ADDRESS1	,
SOURCE_ADDRESS2	,
SOURCE_ADDRESS3	,
SOURCE_ADDRESS4	,
CITY	,
COUNTY	,
STATE_PROV_CODE	,
ZIPCODE	,
WORK_PHONE	,
PAGER_NUM	,
MOBILE_NUM	,
NATIVE_LANG_CODE	,
SEC_FLU_LANG_CODE	
	)
select 
FST_NAME	,
MID_NAME	,
LAST_NAME	,
PREV_LAST_NAME	,
FULL_NAME	,
NAME_PREFIX	,
INDV_TITLE	,
NAME_SUFFIX	,
PARTY_ID	,
EMAIL_ADDR	,
EMP_HIRE_DT	,
ORIG_HIRE_DT	,
ADJ_SERVICE_DT	,
CONTRACT_ST_DT	,
CONTRACT_END_DT	,
EMPLOYEE_NUM	,
SUPERVISOR_NUM	,
SUPERVISOR_NAME	,
CONTINGENT_WORKER_NUM	,
APPLICANT_NUM	,
DEPARTMENT_CODE	,
C22_HELD_POSTN	,
POSITION_TYPE_CODE	,
JOB_TITLE	,
PAR_HELD_POSTN	,
PR_POSTN	,
EMP_FLG	,
SALES_REP_FLG	,
BUYER_FLG	,
REQUESTOR_FLG	,
APPLICANT_FLG	,
MANAGER_FLG	,
LOGIN	,
SRC_EFF_FROM_DT	,
SRC_EFF_TO_DT	,
INTEGRATION_ID	,
X_CUSTOM	,
DELETE_FLG	,
PAR_INTEGRATION_ID	,
VIS_PR_BU_ID	,
VIS_PR_POS_ID	,
CREATED_BY_ID	,
CHANGED_BY_ID	,
CREATED_ON_DT	,
CHANGED_ON_DT	,
AUX1_CHANGED_ON_DT	,
AUX2_CHANGED_ON_DT	,
AUX3_CHANGED_ON_DT	,
LAST_WORKED_DT	,
REQUESTOR_ID	,
BUYER_ID	,
AUX6_CHANGED_ON_DT	,
X_SALESREP_NUMBER	,
PERSON_ID	,
SOURCE_ADDRESS1	,
SOURCE_ADDRESS2	,
SOURCE_ADDRESS3	,
SOURCE_ADDRESS4	,
CITY	,
COUNTY	,
STATE_PROV_CODE	,
ZIPCODE	,
WORK_PHONE	,
PAGER_NUM	,
MOBILE_NUM	,
NATIVE_LANG_CODE	,
SEC_FLU_LANG_CODE		
from  OBIEE_DW.W_EMPLOYEE_DS;

{% endset %}

{% do run_query(sql) %}

{% do log("W_EMPLOYEE_D", info=True) %}

{% endmacro %}