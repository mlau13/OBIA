{{ config (
    materialized="table"
)}}


select	
	
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_FIRST_NAME	   FST_NAME,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_MIDDLE_NAME	   MID_NAME,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_LAST_NAME	   LAST_NAME,
	case 'L,F' when 'L,F' then SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_LAST_NAME||','||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_FIRST_NAME

 when 'L,M,F' then SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_LAST_NAME||','||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_MIDDLE_NAME||','||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_FIRST_NAME

when 'F L' then SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_FIRST_NAME||' '||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_LAST_NAME

when 'F M L' then SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_FIRST_NAME||' '||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_MIDDLE_NAME||' '||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_LAST_NAME

 when 'L F' then SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_LAST_NAME||' '||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_FIRST_NAME

else SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_LAST_NAME||','||SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_FIRST_NAME

end	   FULL_NAME,
	TO_CHAR(SQ_JTF_RS_RESOURCE_EXTNS.RESOURCE_ID)	   PARTY_ID,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_CITY	   CITY,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_COUNTY	   COUNTY,
	COALESCE(SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_STATE,'__UNASSIGNED__')	   STATE_PROV_CODE,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_POSTAL_CODE	   ZIPCODE,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_PHONE	   WORK_PHONE,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_PAGER	   PAGER_NUM,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_MOBILE_PHONE	  MOBILE_NUM,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_EMAIL	   EMAIL_ADDR,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_NUMBER	   EMPLOYEE_NUM,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_JOB_TITLE	  JOB_TITLE,
	COALESCE(SQ_JTF_RS_RESOURCE_EXTNS.PRIMARY_LANGUAGE,'__UNASSIGNED__')	   NATIVE_LANG_CODE,
	COALESCE(SQ_JTF_RS_RESOURCE_EXTNS.SECONDARY_LANGUAGE,'__UNASSIGNED__')	  SEC_FLU_LANG_CODE,
	(CASE
WHEN SQ_JTF_RS_RESOURCE_EXTNS.RESOURCE_ID1 IS NULL THEN 'N'
ELSE 'Y'
END )	   SALES_REP_FLG,
	SQ_JTF_RS_RESOURCE_EXTNS.USER_NAME	   LOGIN,
	'RES~'||TO_CHAR(SQ_JTF_RS_RESOURCE_EXTNS.RESOURCE_ID)	   INTEGRATION_ID,
	SQ_JTF_RS_RESOURCE_EXTNS.DELETE_FLG	    DELETE_FLG,
	SQ_JTF_RS_RESOURCE_EXTNS.LAST_UPDATE_DATE	  CHANGED_ON_DT,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_ADDRESS1	   SOURCE_ADDRESS1,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_ADDRESS2	   SOURCE_ADDRESS2,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_ADDRESS3	   SOURCE_ADDRESS3,
	SQ_JTF_RS_RESOURCE_EXTNS.SOURCE_ADDRESS4	   SOURCE_ADDRESS4
from	
( /* Subselect from SDE_ORA_EmployeeDimension_NonEmployee.W_EMPLOYEE_DS_SQ_JTF_RS_RESOURCE_EXTNS
*/


select 
	   

	   
	   JTF.RESOURCE_ID RESOURCE_ID,
	JTF.START_DATE_ACTIVE START_DATE_ACTIVE,
	JTF.END_DATE_ACTIVE END_DATE_ACTIVE,
	JTF.PRIMARY_LANGUAGE PRIMARY_LANGUAGE,
	JTF.SECONDARY_LANGUAGE SECONDARY_LANGUAGE,
	JTF.SOURCE_NAME SOURCE_NAME,
	JTF.SOURCE_NUMBER SOURCE_NUMBER,
	JTF.SOURCE_JOB_TITLE SOURCE_JOB_TITLE,
	JTF.SOURCE_EMAIL SOURCE_EMAIL,
	JTF.SOURCE_PHONE SOURCE_PHONE,
	SLS.RESOURCE_ID RESOURCE_ID1,
	JTF.SOURCE_CITY SOURCE_CITY,
	JTF.SOURCE_POSTAL_CODE SOURCE_POSTAL_CODE,
	JTF.SOURCE_STATE SOURCE_STATE,
	JTF.SOURCE_COUNTY SOURCE_COUNTY,
	JTF.SOURCE_COUNTRY SOURCE_COUNTRY,
	JTF.SOURCE_FIRST_NAME SOURCE_FIRST_NAME,
	JTF.SOURCE_MIDDLE_NAME SOURCE_MIDDLE_NAME,
	JTF.SOURCE_LAST_NAME SOURCE_LAST_NAME,
	JTF.USER_NAME USER_NAME,
	JTF.SOURCE_MOBILE_PHONE SOURCE_MOBILE_PHONE,
	JTF.SOURCE_PAGER SOURCE_PAGER,
	
'N'
 DELETE_FLG,
	
JTF.LAST_UPDATE_DATE
 LAST_UPDATE_DATE,
	JTF.SOURCE_ADDRESS4 SOURCE_ADDRESS4,
	JTF.SOURCE_ADDRESS3 SOURCE_ADDRESS3,
	JTF.SOURCE_ADDRESS2 SOURCE_ADDRESS2,
	JTF.SOURCE_ADDRESS1 SOURCE_ADDRESS1
from	"PC_FIVETRAN_DB"."ERPPRD_JTF"."JTF_RS_RESOURCE_EXTNS"    JTF LEFT OUTER JOIN 
( /* Subselect from SDE_ORA_EmployeeDimension_NonEmployee.W_EMPLOYEE_DS_JTF_RS_RESOURCE_EXTNS.SLS
*/


select 
	   

	   DISTINCT
	   JTF_RS_SALESREPS.RESOURCE_ID RESOURCE_ID
from	"PC_FIVETRAN_DB"."ERPPRD_JTF"."JTF_RS_SALESREPS"   JTF_RS_SALESREPS
where	(1=1)








)    SLS ON JTF.RESOURCE_ID=SLS.RESOURCE_ID
where	(1=1)

And (JTF.CATEGORY<>'EMPLOYEE')
 And (



    (JTF.LAST_UPDATE_DATE>=TO_DATE(SUBSTR('2002-01-23 11:47:03',0,19),'YYYY-MM-DD HH24:MI:SS'))


)







)   SQ_JTF_RS_RESOURCE_EXTNS
where	(1=1)