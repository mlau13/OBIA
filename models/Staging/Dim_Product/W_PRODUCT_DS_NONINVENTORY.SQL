WITH PRODUCT_NONINV AS(


select	
	
	SQ_NONINVENTORY.SEGMENT1 || '.' || SQ_NONINVENTORY.SEGMENT2	   C1_PART_NUM,
	SQ_NONINVENTORY.CREATED_BY	   C2_CREATED_BY_ID,
	SQ_NONINVENTORY.LAST_UPDATED_BY	   C3_CHANGED_BY_ID,
	SQ_NONINVENTORY.CREATION_DATE	   C4_CREATED_ON_DT,
	SQ_NONINVENTORY.LAST_UPDATE_DATE	   C5_CHANGED_ON_DT,
	'NONINVENTORY~' || TO_CHAR(SQ_NONINVENTORY.CATEGORY_ID)	   C6_INTEGRATION_ID,
	(CASE
WHEN 1100000006='0' THEN NULL
ELSE 1100000006 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C7_PROD_CAT1,
	(CASE
WHEN 1100000022='0' THEN NULL
ELSE 1100000022 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C8_PROD_CAT2,
	(CASE
WHEN 1100000002='0' THEN NULL
ELSE 1100000002 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C9_PROD_CAT3,
	(CASE
WHEN 1100000003='0' THEN NULL
ELSE 1100000003 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C10_PROD_CAT4,
	(CASE
WHEN 1100000005='0' THEN NULL
ELSE 1100000005 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C11_PROD_CAT5,
	(CASE
WHEN 0='0' THEN NULL
ELSE 0 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C12_PROD_CAT6,
	(CASE
WHEN 0='0' THEN NULL
ELSE 0 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C13_PROD_CAT7,
	(CASE
WHEN 0='0' THEN NULL
ELSE 0 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C14_PROD_CAT8,
	(CASE
WHEN 0='0' THEN NULL
ELSE 0 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C15_PROD_CAT9,
	(CASE
WHEN 0='0' THEN NULL
ELSE 0 ||'~'||SQ_NONINVENTORY.CATEGORY_ID
END )	   C16_PROD_CAT10,
	SQ_NONINVENTORY.DELETE_FLG	   C17_DELETE_FLG
from	
( /* Subselect from SDE_ORA_ProductDimension.W_PRODUCT_DS_NONINVENTORY_SQ_NonInv
*/


select 
	   

	   
	   MTL_CATEGORIES_B.SEGMENT1 SEGMENT1,
	MTL_CATEGORIES_B.SEGMENT2 SEGMENT2,
	MTL_CATEGORIES_B.CREATED_BY CREATED_BY,
	MTL_CATEGORIES_B.LAST_UPDATED_BY LAST_UPDATED_BY,
	MTL_CATEGORIES_B.CREATION_DATE CREATION_DATE,
	
 MTL_CATEGORIES_B.LAST_UPDATE_DATE
 LAST_UPDATE_DATE,
	MTL_CATEGORIES_B.CATEGORY_ID CATEGORY_ID,
	
'N'
 DELETE_FLG
from	"PC_FIVETRAN_DB"."ERPPRD_INV"."MTL_CATEGORIES_B"
  MTL_CATEGORIES_B
where	(1=1)

And (

MTL_CATEGORIES_B.LAST_UPDATE_DATE>TO_DATE(SUBSTR('2002-01-23 11:42:07',0,19),'YYYY-MM-DD HH24:MI:SS')

)







)   SQ_NONINVENTORY
where	(1=1)

),

PRODUCT_NONINVTOTAL AS
(
select	
	PART_NUM,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	SRC_EFF_FROM_DT,
	DELETE_FLG,
	DATASOURCE_NUM_ID,
	INTEGRATION_ID,
	PROD_CAT1,
	PROD_CAT2,
	PROD_CAT3,
	PROD_CAT4,
	PROD_CAT5,
	PROD_CAT6,
	PROD_CAT7,
	PROD_CAT8,
	PROD_CAT9,
	PROD_CAT10
	,TO_DATE(SUBSTR('3714-01-01 00:00:00',0,19),'YYYY-MM-DD HH24:MI:SS'),
	'DEFAULT'  TENANT_ID,
	'0' X_CUSTOM,
	'Y' PRODUCT_CATEGORY_FLG,
	141840 ETL_PROC_WID,
	CURRENT_DATE W_INSERT_DT
FROM (	


select 	
	
	C1_PART_NUM PART_NUM,
	C2_CREATED_BY_ID CREATED_BY_ID,
	C3_CHANGED_BY_ID CHANGED_BY_ID,
	C4_CREATED_ON_DT CREATED_ON_DT,
	C5_CHANGED_ON_DT CHANGED_ON_DT,
	TO_DATE(SUBSTR('1899-01-01 00:00:00',0,19),'YYYY-MM-DD HH24:MI:SS') SRC_EFF_FROM_DT,
	C17_DELETE_FLG DELETE_FLG,
	380 DATASOURCE_NUM_ID,
	C6_INTEGRATION_ID INTEGRATION_ID,
	C7_PROD_CAT1 PROD_CAT1,
	C8_PROD_CAT2 PROD_CAT2,
	C9_PROD_CAT3 PROD_CAT3,
	C10_PROD_CAT4 PROD_CAT4,
	C11_PROD_CAT5 PROD_CAT5,
	C12_PROD_CAT6 PROD_CAT6,
	C13_PROD_CAT7 PROD_CAT7,
	C14_PROD_CAT8 PROD_CAT8,
	C15_PROD_CAT9 PROD_CAT9,
	C16_PROD_CAT10 PROD_CAT10 
from	PRODUCT_NONINV
where		(1=1)	






)    ODI_GET_FROM
)

SELECT * FROM PRODUCT_NONINVTOTAL