{{ config (
    materialized="table"
)}}

WITH SALES_ORDER_PA AS (
select	
	
	'SALES_CHANNEL'||'~'||TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SALES_CHANNEL_CODE)	   C1_CHNL_TYPE_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.BILL_TO_ADDRESS_ID)	   C2_CUSTOMER_BILL_TO_LOC_ID,
	SQ_BCI_SALES_ORDLNS_PA.SHIP_TO_ADDRESS_ID	   C3_CUSTOMER_SHIP_TO_LOC_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SOLD_TO_ORG_ID)	   C4_CUSTOMER_ACCOUNT_ID,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.FREIGHT_TERMS_CODE IS NULL THEN  SQ_BCI_SALES_ORDLNS_PA.FREIGHT_TERMS_CODE1
ELSE  SQ_BCI_SALES_ORDLNS_PA.FREIGHT_TERMS_CODE
END )	   C5_FREIGHT_TERMS_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SHIP_FROM_ORG_ID)	   C6_INVENTORY_ORG_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SHIP_TO_ORG_ID)	   C7_INVENTORY_PRODUCT_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.ORG_ID1)	   C8_OPERATING_UNIT_ORG_ID,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.FLOW_STATUS_CODE='CLOSED' OR SQ_BCI_SALES_ORDLNS_PA.FLOW_STATUS_CODE='CANCELLED' THEN  'SALES_ORDER_PROCESS~'||SQ_BCI_SALES_ORDLNS_PA.FLOW_STATUS_CODE
ELSE  (CASE
WHEN NOT SQ_BCI_SALES_ORDLNS_PA.LINE_ID IS NULL THEN 'SALES_ORDER_PROCESS'||'~'||'BLOCKED'
ELSE 'SALES_ORDER_PROCESS~'||SQ_BCI_SALES_ORDLNS_PA.FLOW_STATUS_CODE
END )
END )	   C9_ORDER_STATUS_ID,
	SQ_BCI_SALES_ORDLNS_PA.PAYMENT_TYPE_CODE	   C10_PAYMENT_METHOD_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.PAYMENT_TERM_ID)	   C11_PAYMENT_TERMS_ID,
	'PLANT'||'~'||TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SHIP_FROM_ORG_ID)	   C12_PLANT_LOC_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.INVENTORY_ITEM_ID||'~'||SQ_BCI_SALES_ORDLNS_PA.PS_REV_TYPE)	   C13_PRODUCT_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.ORG_ID1)	   C14_SALES_ORG_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.INVENTORY_ITEM_ID||'~'||SQ_BCI_SALES_ORDLNS_PA.PS_REV_TYPE)	   C15_SALES_PRODUCT_ID,
	(CASE
WHEN LKP_EMP_SALESREP_PERSON_ID.PERSON_ID IS NULL THEN 'SALES_REP~'||TO_CHAR(LKP_EMP_SALESREP_PERSON_ID.SALESREP_ID)
ELSE TO_CHAR(LKP_EMP_SALESREP_PERSON_ID.PERSON_ID)
END )	   C16_SALES_REP_ID,
	'PA_ORDER_TYPE'||'~'||SQ_BCI_SALES_ORDLNS_PA.ORDER_TYPE||'~'||'~EXTERNAL~DROP SHIP'	   C17_XACT_TYPE_ID,
	'SALES_ORDSRC~'||TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.ORDER_SOURCE_ID)	   C18_ORDER_SOURCE_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.PROJECT_ID)	   C19_PROJECT_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.TASK_ID)	   C20_TASK_ID,
	SQ_BCI_SALES_ORDLNS_PA.BOOKED_DATE	   C21_BOOKED_ON_DT,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.CREATION_DATE1 IS NULL THEN  SQ_BCI_SALES_ORDLNS_PA.CREATION_DATE
ELSE  
(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.CREATION_DATE < SQ_BCI_SALES_ORDLNS_PA.CREATION_DATE1 THEN  SQ_BCI_SALES_ORDLNS_PA.CREATION_DATE
ELSE SQ_BCI_SALES_ORDLNS_PA.CREATION_DATE1
END )
END )	   C22_ENTERED_ON_DT,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.LAST_ACK_DATE1 IS NULL THEN  SQ_BCI_SALES_ORDLNS_PA.LAST_ACK_DATE
ELSE  
(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.LAST_ACK_DATE < SQ_BCI_SALES_ORDLNS_PA.LAST_ACK_DATE1 THEN  SQ_BCI_SALES_ORDLNS_PA.LAST_ACK_DATE
ELSE SQ_BCI_SALES_ORDLNS_PA.LAST_ACK_DATE1
END )
END )	   C23_ORDER_ACKNOWLEDGED_DT,
	SQ_BCI_SALES_ORDLNS_PA.ORDERED_DATE	   C24_ORDERED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.PROMISE_DATE	   C25_PROMISED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.REQUEST_DATE1	   C26_REQUIRED_BY_DT,
	NVL(SQ_BCI_SALES_ORDLNS_PA.UNIT_COST,0)*SQ_BCI_SALES_ORDLNS_PA.X_VAR_ORDERED_QTY *((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C27_COST_AMT,
	SQ_BCI_SALES_ORDLNS_PA.X_VAR_ORDERED_QTY*SQ_BCI_SALES_ORDLNS_PA.UNIT_SELLING_PRICE*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C28_NET_AMT,
	SQ_BCI_SALES_ORDLNS_PA.X_VAR_ORDERED_QTY*SQ_BCI_SALES_ORDLNS_PA.UNIT_LIST_PRICE*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C29_LIST_AMT,
	
SQ_BCI_SALES_ORDLNS_PA.X_VAR_ORDERED_QTY*(SQ_BCI_SALES_ORDLNS_PA.UNIT_LIST_PRICE-SQ_BCI_SALES_ORDLNS_PA.UNIT_SELLING_PRICE)*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C30_DISCOUNT_AMT,
	
SQ_BCI_SALES_ORDLNS_PA.ORDERED_QUANTITY*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C31_SALES_QTY,
	
((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.ORDERED_QUANTITY IS NULL THEN 0
ELSE SQ_BCI_SALES_ORDLNS_PA.ORDERED_QUANTITY
END )+NVL(SQ_BCI_SALES_ORDLNS_PA.CANCELLED_QUANTITY,0))*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C32_ORDERED_QTY,
	NVL(SQ_BCI_SALES_ORDLNS_PA.CANCELLED_QUANTITY,0)*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C33_CANCELLED_QTY,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.SHIPPABLE_FLAG = 'Y' THEN SQ_BCI_SALES_ORDLNS_PA.SHIPPED_QUANTITY
ELSE 0
END )*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C34_TOTAL_SHIPPED_QTY,
	
((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.INVOICED_QUANTITY >= 0 THEN  SQ_BCI_SALES_ORDLNS_PA.INVOICED_QUANTITY
ELSE  -1.0*SQ_BCI_SALES_ORDLNS_PA.INVOICED_QUANTITY
END ))*((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END ))	   C35_TOTAL_INVOICED_QTY,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.ORDER_QUANTITY_UOM)	   C36_SALES_UOM_CODE,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.ORDER_NUMBER)	   C37_SALES_ORDER_NUM,
	SQ_BCI_SALES_ORDLNS_PA.LINE_NUMBER	   C38_SALES_ORDER_ITEM,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.COMPONENT_NUMBER IS NULL THEN (CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.OPTION_NUMBER IS NULL THEN  TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SHIPMENT_NUMBER)
ELSE  TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SHIPMENT_NUMBER)||'.'||TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.OPTION_NUMBER)
END )
ELSE TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SHIPMENT_NUMBER)||'.'||TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.OPTION_NUMBER)||'.'||TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.COMPONENT_NUMBER)
END )	   C39_SALES_ORDER_ITEM_DETAIL_NU,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.X_QUOTE_NUMBER)	   C40_REF_DOC_NUM,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.CUST_PO_NUMBER)	   C41_PURCH_ORDER_NUM,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.ITEM_TYPE_CODE)	   C42_ITEM_TYPE_CODE,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.ITEM_TYPE_CODE = 'SERVICE' THEN  'Y'
ELSE  'N'
END )	   C43_SERVICE_FLG,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.PARTIAL_SHIPMENTS_ALLOWED)	   C44_PARTIAL_SHIPMENTS_ALLOWED_,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.BOOKED_FLAG1 IS NULL THEN SQ_BCI_SALES_ORDLNS_PA.BOOKED_FLAG
ELSE SQ_BCI_SALES_ORDLNS_PA.BOOKED_FLAG1
END )	   C45_BOOKING_FLG,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.FULFILLED_FLAG)	   C46_FULFILLED_FLG,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.OPEN_FLAG = 'Y' AND ((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG IS NULL THEN SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG1
ELSE SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG
END )) = 'N' AND SQ_BCI_SALES_ORDLNS_PA.ORDERED_QUANTITY > 0 AND (SQ_BCI_SALES_ORDLNS_PA.SCHEDULE_STATUS_CODE IS NULL OR SQ_BCI_SALES_ORDLNS_PA.SCHEDULE_STATUS_CODE <> 'SCHEDULED') THEN  'Y'
ELSE  'N'
END )	   C47_FIN_BACKLOG_FLG,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.SCHEDULE_STATUS_CODE ='SCHEDULED' THEN 'Y'
ELSE 'N'
END )		   C48_SCHEDULED_FLG,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.OPEN_FLAG = 'Y' AND ((CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG IS NULL THEN SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG1
ELSE SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG
END )) = 'N' AND SQ_BCI_SALES_ORDLNS_PA.SHIPPABLE_FLAG = 'Y' AND SQ_BCI_SALES_ORDLNS_PA.ORDERED_QUANTITY > 0 AND (SQ_BCI_SALES_ORDLNS_PA.SCHEDULE_STATUS_CODE IS NULL OR SQ_BCI_SALES_ORDLNS_PA.SCHEDULE_STATUS_CODE <> 'SCHEDULED') THEN  'Y'
ELSE  'N'
END )  	   C49_OPR_BACKLOG_FLG,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG = 'N' AND SQ_BCI_SALES_ORDLNS_PA.SHIPPABLE_FLAG = 'Y' THEN  'Y'
ELSE  'N'
END )	 	   C50_SHIPPABLE_FLG,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.CANCELLED_FLAG = 'N' THEN  'Y'
ELSE  'N'
END )	   C51_BILLING_FLG,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.INVOICE_INTERFACE_STATUS_CODE IS NULL THEN  NULL
ELSE  (CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.INVOICE_INTERFACE_STATUS_CODE = 'YES' THEN  'Y'
ELSE  'N'
END )
END )	   C52_INVOICE_INTERFACED_FLG,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SHIPPING_INTERFACED_FLAG)	   C53_SHIPPING_INTERFACED_FLG,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.HEADER_ID)	   C54_SALES_ORDER_HD_ID,
	 (CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.TOP_MODEL_LINE_ID IS NULL THEN  TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.LINE_ID)
ELSE TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.TOP_MODEL_LINE_ID)
END )	   C55_SALES_ORDER_LN_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.LINE_ID)||'~'||TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.INVENTORY_ITEM_ID||'~'||SQ_BCI_SALES_ORDLNS_PA.PS_REV_TYPE)||'~'||to_char(SQ_BCI_SALES_ORDLNS_PA.SHIP_FROM_ORG_ID)	   C56_BOOKING_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.TRANSACTIONAL_CURR_CODE)	   C57_DOC_CURR_CODE,
	SQ_BCI_SALES_ORDLNS_PA.CONVERSION_RATE	   C58_LOC_EXCHANGE_RATE,
	SQ_BCI_SALES_ORDLNS_PA.ORDERED_DATE	   C59_EXCHANGE_DT,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.CREATED_BY_ID)	   C60_CREATED_BY_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.CHANGED_BY_ID)	   C61_CHANGED_BY_ID,
	SQ_BCI_SALES_ORDLNS_PA.CREATION_DATE	   C62_CREATED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.CHANGED_ON_DT	   C63_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.PAA_LAST_UPDATE_DATE	   C64_AUX1_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.PPF_LAST_UPDATE_DATE	   C65_AUX2_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.LAST_UPDATE_DATE2	   C66_AUX3_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.PPA_LAST_UPDATE_DATE	   C67_AUX4_CHANGED_ON_DT,
	 'PA' || '~' || TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.LINE_ID) || '~'|| TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.PROJECT_FUNDING_ID) || '~'|| TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.AGREEMENT_ID) 	   C68_INTEGRATION_ID,
	SQ_BCI_SALES_ORDLNS_PA.X_PRICING_ATTRIBUTE28	   C69_X_PRICING_ATTRIBUTE28,
	SQ_BCI_SALES_ORDLNS_PA.X_SERVICE_START_DATE	   C70_X_SERVICE_START_DATE,
	SQ_BCI_SALES_ORDLNS_PA.X_SERVICE_END_DATE	   C71_X_SERVICE_END_DATE,
	SQ_BCI_SALES_ORDLNS_PA.X_SERVICE_REFERENCE_TYPE_CODE	   C72_X_SERVICE_REFERENCE_TYPE_C,
	SQ_BCI_SALES_ORDLNS_PA.X_SERVICE_REFERENCE_LINE_ID	   C73_X_SERVICE_REFERENCE_LINE_I,
	'999.'||to_char(SQ_BCI_SALES_ORDLNS_PA.HEADER_ID)	   C74_X_LICENSE_ID,
	SQ_BCI_SALES_ORDLNS_PA.X_ORDER_SOURCE	   C75_X_ORDER_SOURCE,
	SQ_BCI_SALES_ORDLNS_PA.SIMPLIFIED_CONTRACT_NUMBER	   C76_X_SIMPLIFIED_CONTRACT_NUMB,
	SQ_BCI_SALES_ORDLNS_PA.LENGTH_OF_CONTRACT	   C77_X_LENGTH_OF_CONTRACT,
	SQ_BCI_SALES_ORDLNS_PA.X_COVERED_INVENTORY_ITEM_ID	   C78_X_COVERED_INVENTORY_ITEM_I,
	TO_NUMBER(SQ_BCI_SALES_ORDLNS_PA.X_SOB_ID)	   C79_X_SOB_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.SOB_CURRENCY_CODE)	   C80_X_SOB_CURRENCY_CODE,
	TO_NUMBER(SQ_BCI_SALES_ORDLNS_PA.ALLOCATED_AMOUNT)	   C81_X_ALLOCATED_AMOUNT,
	(CASE
WHEN SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE IS NULL THEN 1
ELSE SQ_BCI_SALES_ORDLNS_PA.X_CREDIT_PERCENTAGE/100
END )	   C82_X_CREDIT_PERCENTAGE,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.ORDER_TYPE)	   C83_X_ORDER_TYPE,
	SQ_BCI_SALES_ORDLNS_PA.X_QUOTE_NUMBER	   C84_X_QUOTE_NUMBER,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.PROJECT_NAME)	   C85_X_PROJECT_NAME,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.TARGET_OS)	   C86_X_TARGET_OS,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.TYPE_OF_SERVICE)	   C87_X_TYPE_OF_SERVICE,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.LICENSE_APP_CODE)	   C88_X_LICENSE_APP_CODE,
	TO_NUMBER(SQ_BCI_SALES_ORDLNS_PA.SERVICE_LINE_DIRECTOR)	   C89_X_SERVICE_LINE_DIRECTOR,
	SQ_BCI_SALES_ORDLNS_PA.CREDIT_RECEIVER_ID	   C90_X_SALES_CREDIT_ID,
	SQ_BCI_SALES_ORDLNS_PA.FLOW_STATUS_CODE	   C91_X_LINE_STATUS,
	'DIRECT'	   C92_X_SALES_CHANNEL_CODE,
	SQ_BCI_SALES_ORDLNS_PA.CREDIT_TYPE_CODE	   C93_X_CREDIT_TYPE_CODE,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.X_BILL_TO_CUSTOMER_ID)	   C94_X_BILL_TO_CUSTOMER_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.X_SHIP_TO_CUSTOMER_ID)	   C95_X_SHIP_TO_CUSTOMER_ID,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.X_SOLD_TO_CUSTOMER_ID)	   C96_X_SOLD_TO_CUSTOMER_ID,
	SQ_BCI_SALES_ORDLNS_PA.FLOW_STATUS_CODE	   C97_X_ORDER_STATUS,
	SQ_BCI_SALES_ORDLNS_PA.SALESREP_ID	   C98_X_SALESREP_ID,
	SQ_BCI_SALES_ORDLNS_PA.X_TRX_NUMBER	   C99_X_INV_NUMBER,
	SQ_BCI_SALES_ORDLNS_PA.X_LINE_NUMBER	   C100_X_INV_LINE_NUM,
	SQ_BCI_SALES_ORDLNS_PA.X_TRX_DATE	   C101_X_INV_DT,
	'999.'||to_char(SQ_BCI_SALES_ORDLNS_PA.HEADER_ID)	   C102_X_SALES_SPLIT_LINE_WID,
	SQ_BCI_SALES_ORDLNS_PA.TASK_NAME	   C103_X_TASK_NAME,
	SQ_BCI_SALES_ORDLNS_PA.INVENTORY_ITEM_ID||'~'||SQ_BCI_SALES_ORDLNS_PA.PS_REV_TYPE	   C104_X_REVN_TYPE_PRODUCT_ID,
	SQ_BCI_SALES_ORDLNS_PA.PRODUCT_GROUP	   C105_X_PS_PRODUCT_GROUP,
	SQ_BCI_SALES_ORDLNS_PA.BUSINESS_UNIT	   C106_X_PS_BUSINESS_UNIT,
	SQ_BCI_SALES_ORDLNS_PA.PS_REV_TYPE	   C107_X_PS_REV_TYPE,
	SQ_BCI_SALES_ORDLNS_PA.PRODUCT_UNIT	   C108_X_PS_PRODUCT_UNIT,
	SQ_BCI_SALES_ORDLNS_PA.X_CONTRACT_START_DATE	   C109_X_CONTRACT_START_DATE,
	SQ_BCI_SALES_ORDLNS_PA.X_CONTRACT_END_DATE	   C110_X_CONTRACT_END_DATE,
	TO_CHAR(SQ_BCI_SALES_ORDLNS_PA.PROJECT_MANAGER)	   C111_X_PROJECT_MANAGER,
	SQ_BCI_SALES_ORDLNS_PA.X_INTERFACE_LINE_ATTRIBUTE6	   C112_X_INTERFACE_LINE_ATTRIBUT,
	SQ_BCI_SALES_ORDLNS_PA.X_CUSTOMER_TRX_ID	   C113_X_CUSTOMER_TRX_ID,
	SQ_BCI_SALES_ORDLNS_PA.X_CUSTOMER_TRX_LINE_ID	   C114_X_CUSTOMER_TRX_LINE_ID,
	SQ_BCI_SALES_ORDLNS_PA.X_PRE_CUSTOMER_TRX_LINE_ID	   C115_X_PR_CUSTOMER_TRX_LINE_ID,
	SQ_BCI_SALES_ORDLNS_PA.INVOICE_UPDATE	   C116_AUX6_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.TOS_UPDATE_DATE	   C117_AUX7_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.PG_UPDATE_DATE	   C118_AUX8_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.PU_UPDATE_DATE	   C119_AUX9_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.LAC_UPDATE_DATE	   C120_AUX10_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.AUX3_CHANGED_ON_DT	   C121_AUX5_CHANGED_ON_DT,
	SQ_BCI_SALES_ORDLNS_PA.X_GROUP_LINE_NUM	   C122_X_GROUP_LINE_NUM,
	SQ_BCI_SALES_ORDLNS_PA.X_ATTRIBUTE_CATEGORY	   C123_X_ATTRIBUTE_CATEGORY,
	SQ_BCI_SALES_ORDLNS_PA.X_ATTRIBUTE2	   C124_X_ATTRIBUTE2,
	SQ_BCI_SALES_ORDLNS_PA.X_ATTRIBUTE3	   C125_X_ATTRIBUTE3,
	SQ_BCI_SALES_ORDLNS_PA.X_ATTRIBUTE4	   C126_X_ATTRIBUTE4,
	SQ_BCI_SALES_ORDLNS_PA.SOLD_TO_CONTACT_ID	   C127_SOLD_TO_CONTACT_ID,
	SQ_BCI_SALES_ORDLNS_PA.SHIP_TO_ORG_ID	   C128_SHIP_TO_ORG_ID,
	SQ_BCI_SALES_ORDLNS_PA.X_SET_OF_BOOKS_ID	   C129_X_SET_OF_BOOKS_ID
from	(
( /* Subselect from WR_SDE_ORA_SalesOrderLinesFact.W_SALES_ORDER_LINE_FS_SQ_ORDLS_PA
*/


select 
	   

	   DISTINCT
	   PPA.PROJECT_ID HEADER_ID,
	PAA.AGREEMENT_ID ORDER_TYPE_ID,
	PPA.SEGMENT1 ORDER_NUMBER,
	PPF.DATE_ALLOCATED ORDERED_DATE,
	PPF.FUNDING_CURRENCY_CODE TRANSACTIONAL_CURR_CODE,
	PAA.AGREEMENT_NUM CUST_PO_NUMBER,
	PAA.TERM_ID PAYMENT_TERM_ID,
	PPC.CUSTOMER_ID SOLD_TO_ORG_ID,
	PPA.PROJECT_ID PROJECT_ID,
	PT.TASK_ID TASK_ID,
	PPA.CREATION_DATE CREATION_DATE,
	PPA.PROJECT_STATUS_CODE HEADER_FLOW_STATUS_CODE,
	PPF.DATE_ALLOCATED BOOKED_DATE,
	PT.TASK_ID LINE_ID,
	PAA.ORG_ID ORG_ID1,
	PT.TASK_NUMBER LINE_NUMBER,
	PPC.CUSTOMER_ID SHIP_TO_ORG_ID,
	PPC.CUSTOMER_ID INVOICE_TO_ORG_ID,
	'WR~PS-PROD~'||PPCS_TARGET_OS.CLASS_CODE||'~'||NVL(PPF.ATTRIBUTE8,PPCS_PRODUCT_GP.CLASS_CODE)||'~'||NVL(PPF.ATTRIBUTE4,PPCS_PRODUCT_UNIT.CLASS_CODE) INVENTORY_ITEM_ID,
	PPF.ALLOCATED_AMOUNT UNIT_SELLING_PRICE,
	PPF.PROJECT_ALLOCATED_AMOUNT UNIT_LIST_PRICE,
	PT.CREATION_DATE CREATION_DATE1,
	PT.CREATED_BY CREATED_BY_ID,
	PT.LAST_UPDATE_DATE CHANGED_ON_DT,
	PT.LAST_UPDATED_BY CHANGED_BY_ID,
	PPA.PROJECT_STATUS_CODE SCHEDULE_STATUS_CODE,
	PPA.PROJECT_STATUS_CODE FLOW_STATUS_CODE,
	PPA.LAST_UPDATE_DATE LAST_UPDATE_DATE2,
	PPP.LAST_UPDATE_DATE AUX3_CHANGED_ON_DT,
	PPA.PROJECT_STATUS_CODE INVOICE_INTERFACE_STATUS_CODE,
	'0' X_CUSTOM,
	NVL(TO_CHAR(TO_DATE(PPF.ATTRIBUTE5,'YYYY/MM/DD HH24:MI:SS'),'DD-MON-YYYY'),PPA.START_DATE) X_SERVICE_START_DATE,
	NVL(TO_CHAR(TO_DATE(PPF.ATTRIBUTE6,'YYYY/MM/DD HH24:MI:SS'),'DD-MON-YYYY'),PPA.COMPLETION_DATE) X_SERVICE_END_DATE,
	A_SOB.SOB_ID X_SOB_ID,
	PAA.DESCRIPTION X_QUOTE_NUMBER,
	PPC.BILL_TO_CUSTOMER_ID X_BILL_TO_CUSTOMER_ID,
	PPC.SHIP_TO_CUSTOMER_ID X_SHIP_TO_CUSTOMER_ID,
	PPC.CUSTOMER_ID X_SOLD_TO_CUSTOMER_ID,
	INVOICE_LKP.TRX_DATE X_TRX_DATE,
	INVOICE_LKP.TRX_NUMBER X_TRX_NUMBER,
	INVOICE_LKP.LINE_NUMBER X_LINE_NUMBER,
	INVOICE_LKP.INTERFACE_LINE_ATTRIBUTE6 X_INTERFACE_LINE_ATTRIBUTE6,
	INVOICE_LKP.CUSTOMER_TRX_ID X_CUSTOMER_TRX_ID,
	INVOICE_LKP.CUSTOMER_TRX_LINE_ID X_CUSTOMER_TRX_LINE_ID,
	INVOICE_LKP.PREVIOUS_CUSTOMER_TRX_LINE_ID X_PRE_CUSTOMER_TRX_LINE_ID,
	CASE WHEN 
NVL(PPF.ATTRIBUTE7,PPCS_TYPE_OF_SERVICE.CLASS_CODE)='Aptiv Developer' THEN 'MAINTENANCE' ELSE
CASE WHEN PT.TASK_NUMBER  = '10.0'
            THEN 'SERVICES'
            WHEN PT.TASK_NUMBER  = '1.0'
            THEN 'SERVICES'
            WHEN PT.TASK_NUMBER  = '12.0'
            THEN 'SERVICES'
            WHEN PT.TASK_NUMBER  = '2.0'
            THEN 'SERVICES'
            WHEN PT.TASK_NUMBER  = '13.0'
            THEN CASE WHEN UPPER(HOU.NAME) like '%EDUCATION%' 
                THEN 'TRAINING' 
                ELSE 'SERVICES'
                END
            WHEN PT.TASK_NUMBER  = '9.0'
            THEN 'TRAINING'
			WHEN PT.TASK_NUMBER  = '15.0'
            THEN 'SERVICES'
            WHEN PT.TASK_NUMBER  = '11.0'
            THEN CASE WHEN UPPER(HOU.NAME) like '%PREMIUM SUPPORT%'
                THEN 'MAINTENANCE' 
                ELSE 'SERVICES'
                END 
            ELSE 'SERVICES'
            END END PS_REV_TYPE,
	HOU.NAME BUSINESS_UNIT,
	PPCS_PRODUCT_UNIT.LAST_UPDATE_DATE PU_UPDATE_DATE,
	PPCS_PRODUCT_GP.LAST_UPDATE_DATE PG_UPDATE_DATE,
	PPCS_LIC_APP_CODE.LAST_UPDATE_DATE LAC_UPDATE_DATE,
	PPCS_TYPE_OF_SERVICE.LAST_UPDATE_DATE TOS_UPDATE_DATE,
	PPCS_TARGET_OS.LAST_UPDATE_DATE TARGET_UPDATE_DATE,
	NVL(PPF.ATTRIBUTE8,PPCS_PRODUCT_GP.CLASS_CODE) PRODUCT_GROUP,
	PT.TASK_NAME TASK_NAME,
	PPC.SHIP_TO_ADDRESS_ID SHIP_TO_ADDRESS_ID,
	PPC.BILL_TO_ADDRESS_ID BILL_TO_ADDRESS_ID,
	PAA.AGREEMENT_ID AGREEMENT_ID,
	PPP.PROJECT_PARTY_ID PROJECT_PARTY_ID,
	PPF.PROJECT_FUNDING_ID PROJECT_FUNDING_ID,
	PPP4.PERSON_ID FAE,
	PPP3.PERSON_ID PROJECT_MANAGER,
	PPP.PERSON_ID SERVICE_LINE_DIRECTOR,
	PPCS_LIC_APP_CODE.CLASS_CODE LICENSE_APP_CODE,
	NVL(PPF.ATTRIBUTE7,PPCS_TYPE_OF_SERVICE.CLASS_CODE) TYPE_OF_SERVICE,
	PPCS_TARGET_OS.CLASS_CODE TARGET_OS,
	PPA.LONG_NAME PROJECT_NAME,
	PAA.AGREEMENT_TYPE ORDER_TYPE,
	PAA.LAST_UPDATE_DATE PPA_LAST_UPDATE_DATE,
	PPF.LAST_UPDATE_DATE PPF_LAST_UPDATE_DATE,
	PPC.LAST_UPDATE_DATE PAA_LAST_UPDATE_DATE,
	PPF.ALLOCATED_AMOUNT ALLOCATED_AMOUNT,
	NVL(PPF.ATTRIBUTE4,PPCS_PRODUCT_UNIT.CLASS_CODE) PRODUCT_UNIT,
	TO_CHAR(LKP_HR_OPERATING_UNITS.SET_OF_BOOKS_ID) X_SET_OF_BOOKS_ID,
	INVOICE_LKP.INVOICE_UPDATE INVOICE_UPDATE,
	PPF.ATTRIBUTE9 X_GROUP_LINE_NUM,
	PPA.START_DATE X_CONTRACT_START_DATE,
	PPA.COMPLETION_DATE X_CONTRACT_END_DATE,
	PPF.ATTRIBUTE_CATEGORY X_ATTRIBUTE_CATEGORY,
	PPF.ATTRIBUTE2 X_ATTRIBUTE2,
	PPF.ATTRIBUTE3 X_ATTRIBUTE3,
	PPF.ATTRIBUTE4 X_ATTRIBUTE4,
	null CONVERSION_RATE,
	null PARTIAL_SHIPMENTS_ALLOWED,
	null SOLD_TO_CONTACT_ID,
	'Y' BOOKED_FLAG,
	null SALESREP_ID,
	null PAYMENT_TYPE_CODE,
	null SALES_CHANNEL_CODE,
	null LAST_ACK_DATE,
	null REQUEST_DATE1,
	null PROMISE_DATE,
	null SCHEDULE_SHIP_DATE,
	null ORDER_QUANTITY_UOM,
	null CANCELLED_QUANTITY,
	null SHIPPED_QUANTITY,
	1 ORDERED_QUANTITY,
	null SHIP_FROM_ORG_ID,
	null FREIGHT_TERMS_CODE,
	null TOP_MODEL_LINE_ID,
	null ITEM_TYPE_CODE,
	null LINE_CATEGORY_CODE,
	null CANCELLED_FLAG,
	'Y' BOOKED_FLAG1,
	null LAST_ACK_DATE1,
	1 INVOICED_QUANTITY,
	null SHIPPABLE_FLAG,
	null NAME,
	null AGREEMENT_NUM,
	null CANCELLED_FLAG1,
	null OPEN_FLAG,
	null SHIPMENT_NUMBER,
	null CONVERSION_TYPE_CODE,
	null FULFILLED_FLAG,
	null SHIPPING_INTERFACED_FLAG,
	null OPTION_NUMBER,
	null COMPONENT_NUMBER,
	null SOURCE_TYPE_CODE,
	null ORDER_SOURCE_ID,
	null UNIT_COST,
	null X_PRICING_ATTRIBUTE28,
	null X_SERVICE_REFERENCE_TYPE_CODE,
	null X_SERVICE_REFERENCE_LINE_ID,
	'PA' X_ORDER_SOURCE,
	100 X_CREDIT_PERCENTAGE,
	null X_COVERED_INVENTORY_ITEM_ID,
	null CREDIT_TYPE_CODE,
	null CREDIT_RECEIVER_ID,
	null SOB_CURRENCY_CODE,
	null LENGTH_OF_CONTRACT,
	null SIMPLIFIED_CONTRACT_NUMBER,
	null LICENSE_ID,
	1 X_VAR_ORDERED_QTY,
	null FREIGHT_TERMS_CODE1
from	"PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_AGREEMENTS_ALL"   PAA, 
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_FUNDINGS"   PPF,
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECTS_ALL"   PPA, 
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_TASKS"   PT, 
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_CUSTOMERS"   PPC, 
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_CLASSES"   PPCS_TARGET_OS, 
 "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_CLASSES"    PPCS_TYPE_OF_SERVICE, 
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_CLASSES"   PPCS_LIC_APP_CODE, 
 "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_PLAYERS"  PPP, 
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_PLAYERS"   PPP3, 
 "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_PLAYERS"  PPP4, 
 "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_CLASSES"   PPCS_PRODUCT_GP, 
  "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_CLASSES"  PPCS_PRODUCT_UNIT, 
  "PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ORGANIZATION_UNITS"   HOU, (

select 	
	MAX(RA_CUSTOMER_TRX_ALL.TRX_NUMBER)    TRX_NUMBER,	MAX(RA_CUSTOMER_TRX_ALL.TRX_DATE)    TRX_DATE,	MAX(RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE6)    INTERFACE_LINE_ATTRIBUTE6,	MAX(RA_CUSTOMER_TRX_LINES_ALL.LINE_NUMBER)    LINE_NUMBER,	MAX(RA_CUSTOMER_TRX_LINES_ALL.PREVIOUS_CUSTOMER_TRX_LINE_ID)    PREVIOUS_CUSTOMER_TRX_LINE_ID,	MAX(RA_CUSTOMER_TRX_LINES_ALL.CUSTOMER_TRX_ID)    CUSTOMER_TRX_ID,	MAX(RA_CUSTOMER_TRX_LINES_ALL.CUSTOMER_TRX_LINE_ID)    CUSTOMER_TRX_LINE_ID,	PDI.PROJECT_ID    PROJECT_ID,	MAX(RA_CUSTOMER_TRX_LINES_ALL.LAST_UPDATE_DATE)    LAST_UPDATE_DATE,	MAX(PDI.LAST_UPDATE_DATE)    INVOICE_UPDATE
from	"PC_FIVETRAN_DB"."ERPPRD1_AR"."RA_CUSTOMER_TRX_ALL"   RA_CUSTOMER_TRX_ALL, 
    "PC_FIVETRAN_DB"."ERPPRD1_AR"."RA_CUSTOMER_TRX_LINES_ALL"   RA_CUSTOMER_TRX_LINES_ALL,
    "PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_DRAFT_INVOICES_ALL"   PDI
where	(1=1)
 And (RA_CUSTOMER_TRX_ALL.CUSTOMER_TRX_ID =  RA_CUSTOMER_TRX_LINES_ALL.CUSTOMER_TRX_ID)
AND (PDI.SYSTEM_REFERENCE = RA_CUSTOMER_TRX_ALL.CUSTOMER_TRX_ID)
And (RA_CUSTOMER_TRX_ALL.TRX_NUMBER IS NOT NULL)
Group By PDI.PROJECT_ID

)   INVOICE_LKP, 
( /* Subselect from WR_SDE_ORA_SalesOrderLinesFact.W_SALES_ORDER_LINE_FS_SQ_A_SOB_PA
*/


select 
	   

	   
	   HR_OPERATING_UNITS.ORGANIZATION_ID ORG_ID,
	GL_LEDGERS.LEDGER_ID SOB_ID
from	( SELECT O.BUSINESS_GROUP_ID , O.ORGANIZATION_ID , OTL.NAME , O.DATE_FROM , O.DATE_TO ,  O3.ORG_INFORMATION5 SHORT_CODE  , O3.ORG_INFORMATION3 SET_OF_BOOKS_ID , O3.ORG_INFORMATION2 DEFAULT_LEGAL_CONTEXT_ID  , O3.ORG_INFORMATION6  USABLE_FLAG FROM 
"PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ALL_ORGANIZATION_UNITS" O, "PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ALL_ORGANIZATION_UNITS_TL" OTL, "PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ORGANIZATION_INFORMATION" O2, 
"PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ORGANIZATION_INFORMATION" O3 WHERE
O.ORGANIZATION_ID = O2.ORGANIZATION_ID AND O.ORGANIZATION_ID = O3.ORGANIZATION_ID AND O2.ORG_INFORMATION_CONTEXT||'' = 'CLASS' AND 
O3.ORG_INFORMATION_CONTEXT = 'Operating Unit Information' AND O2.ORG_INFORMATION1 = 'OPERATING_UNIT' AND O2.ORG_INFORMATION2 = 'Y' AND
O.ORGANIZATION_ID = OTL.ORGANIZATION_ID AND OTL.LANGUAGE = 'US')   HR_OPERATING_UNITS, "PC_FIVETRAN_DB"."ERPPRD1_GL"."GL_LEDGERS"   GL_LEDGERS
where	(1=1)
 And (HR_OPERATING_UNITS.SET_OF_BOOKS_ID=GL_LEDGERS.LEDGER_ID)








)   A_SOB, ( SELECT O.BUSINESS_GROUP_ID , O.ORGANIZATION_ID , OTL.NAME , O.DATE_FROM , O.DATE_TO ,  O3.ORG_INFORMATION5 SHORT_CODE  , O3.ORG_INFORMATION3 SET_OF_BOOKS_ID , O3.ORG_INFORMATION2 DEFAULT_LEGAL_CONTEXT_ID  , O3.ORG_INFORMATION6  USABLE_FLAG FROM 
"PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ALL_ORGANIZATION_UNITS" O, "PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ALL_ORGANIZATION_UNITS_TL" OTL, "PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ORGANIZATION_INFORMATION" O2, 
"PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ORGANIZATION_INFORMATION" O3 WHERE
O.ORGANIZATION_ID = O2.ORGANIZATION_ID AND O.ORGANIZATION_ID = O3.ORGANIZATION_ID AND O2.ORG_INFORMATION_CONTEXT||'' = 'CLASS' AND 
O3.ORG_INFORMATION_CONTEXT = 'Operating Unit Information' AND O2.ORG_INFORMATION1 = 'OPERATING_UNIT' AND O2.ORG_INFORMATION2 = 'Y' AND
O.ORGANIZATION_ID = OTL.ORGANIZATION_ID AND OTL.LANGUAGE = 'US')   LKP_HR_OPERATING_UNITS
where	(1=1)
 And (PAA.AGREEMENT_ID = PPF.AGREEMENT_ID(+))
AND (PPF.PROJECT_ID = PPA.PROJECT_ID (+))
AND (PPF.PROJECT_ID = PT.PROJECT_ID(+)  AND PPF.TASK_ID = PT.TASK_ID(+))
AND (PPA.PROJECT_ID = PPC.PROJECT_ID(+))
AND (PPA.PROJECT_ID = PPCS_TARGET_OS.PROJECT_ID(+)
AND PPCS_TARGET_OS.CLASS_CATEGORY(+) = 'Target - OS')
AND (PPA.PROJECT_ID = PPCS_TYPE_OF_SERVICE.PROJECT_ID(+) 
AND PPCS_TYPE_OF_SERVICE.CLASS_CATEGORY(+) = 'Type of Service')
AND (PPA.PROJECT_ID = PPCS_LIC_APP_CODE.PROJECT_ID(+) 
AND PPCS_LIC_APP_CODE.CLASS_CATEGORY(+) = 'Industry Types')
AND (PPA.PROJECT_ID = PPCS_PRODUCT_GP.PROJECT_ID(+) 
AND PPCS_PRODUCT_GP.CLASS_CATEGORY(+) = 'Product Group')
AND (PPA.PROJECT_ID = PPCS_PRODUCT_UNIT.PROJECT_ID(+) 
AND PPCS_PRODUCT_UNIT.CLASS_CATEGORY(+) = 'Product Unit')
AND (PPA.CARRYING_OUT_ORGANIZATION_ID = HOU.ORGANIZATION_ID(+))
AND (PPA.PROJECT_ID = PPP.PROJECT_ID(+) 
AND PPP.PROJECT_ROLE_TYPE(+) = '1045' 
AND PPP.END_DATE_ACTIVE(+) IS NULL)
AND (PPA.PROJECT_ID = PPP3.PROJECT_ID(+) 
AND PPP3.PROJECT_ROLE_TYPE(+) = 'PROJECT MANAGER' 
AND PPP3.END_DATE_ACTIVE(+) IS NULL)
AND (PPA.PROJECT_ID = PPP4.PROJECT_ID(+) 
AND PPP4.PROJECT_ROLE_TYPE(+) = 'PROJECT MANAGER' 
AND PPP4.END_DATE_ACTIVE(+) IS NULL)
AND (PPA.PROJECT_ID = INVOICE_LKP.PROJECT_ID(+))
AND (PAA.ORG_ID = A_SOB.ORG_ID (+))
AND (PAA.ORG_ID=LKP_HR_OPERATING_UNITS.ORGANIZATION_ID (+))
//And (PPP.START_DATE_ACTIVE = (SELECT MAX(PPP2.START_DATE_ACTIVE)
//                                  FROM  PPP2"PC_FIVETRAN_DB"."ERPPRD1_PA"."PA_PROJECT_PLAYERS"
//                                  WHERE PPP2.PROJECT_ROLE_TYPE = '1045'
//                                    AND PPP.PROJECT_ID = PPP2.PROJECT_ID
//                                  GROUP BY PROJECT_ID)
//OR PPP.START_DATE_ACTIVE IS NULL)
 And (



 (PPA.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS')OR
   PT.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PAA.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPF.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPC.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPCS_TARGET_OS.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPCS_TYPE_OF_SERVICE.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPCS_LIC_APP_CODE.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPCS_PRODUCT_GP.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPCS_PRODUCT_UNIT.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS') OR
   PPP.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS')
   OR INVOICE_LKP.INVOICE_UPDATE>=TO_DATE(SUBSTR('2002-02-21 15:34:06',0,19),'YYYY-MM-DD HH24:MI:SS'))

   
)







)    SQ_BCI_SALES_ORDLNS_PA LEFT OUTER JOIN 
( /* Subselect from LKP_EMPL_SALESREP_PERSON_ID
*/


select 
	   

	   
	   DECODE(ROW_NUMBER() OVER (PARTITION BY SR.SALESREP_ID ORDER BY RES.SOURCE_ID),1,1,0) LKP_ACTIVE,
	RES.SOURCE_ID PERSON_ID,
	SR.SALESREP_ID SALESREP_ID
from	"PC_FIVETRAN_DB"."ERPPRD1_JTF"."JTF_RS_SALESREPS"   SR, "PC_FIVETRAN_DB"."ERPPRD1_JTF"."JTF_RS_RESOURCE_EXTNS"   RES
where	(1=1)
 And (SR.RESOURCE_ID=RES.RESOURCE_ID)

And (RES.CATEGORY='EMPLOYEE')







)    LKP_EMP_SALESREP_PERSON_ID ON SQ_BCI_SALES_ORDLNS_PA.SALESREP_ID=LKP_EMP_SALESREP_PERSON_ID.SALESREP_ID) 
LEFT OUTER JOIN ( SELECT O.BUSINESS_GROUP_ID , O.ORGANIZATION_ID , OTL.NAME , O.DATE_FROM , O.DATE_TO ,  O3.ORG_INFORMATION5 SHORT_CODE  , O3.ORG_INFORMATION3 SET_OF_BOOKS_ID , O3.ORG_INFORMATION2 DEFAULT_LEGAL_CONTEXT_ID  , O3.ORG_INFORMATION6  USABLE_FLAG FROM 
"PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ALL_ORGANIZATION_UNITS" O, "PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ALL_ORGANIZATION_UNITS_TL" OTL, "PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ORGANIZATION_INFORMATION" O2, 
"PC_FIVETRAN_DB"."ERPPRD1_HR"."HR_ORGANIZATION_INFORMATION" O3 WHERE
O.ORGANIZATION_ID = O2.ORGANIZATION_ID AND O.ORGANIZATION_ID = O3.ORGANIZATION_ID AND O2.ORG_INFORMATION_CONTEXT||'' = 'CLASS' AND 
O3.ORG_INFORMATION_CONTEXT = 'Operating Unit Information' AND O2.ORG_INFORMATION1 = 'OPERATING_UNIT' AND O2.ORG_INFORMATION2 = 'Y' AND
O.ORGANIZATION_ID = OTL.ORGANIZATION_ID AND OTL.LANGUAGE = 'US')    HR_OPERATING_UNITS ON SQ_BCI_SALES_ORDLNS_PA.ORG_ID1=HR_OPERATING_UNITS.ORGANIZATION_ID
where	(1=1)
),

SALES_ORDER_PA_TOTAL AS
(
  select	
	CHNL_TYPE_ID,
	CUSTOMER_BILL_TO_LOC_ID,
	CUSTOMER_CNTCT_ID,
	CUSTOMER_SHIP_TO_LOC_ID,
	CUSTOMER_ACCOUNT_ID,
	FREIGHT_TERMS_ID,
	INVENTORY_ORG_ID,
	INVENTORY_PRODUCT_ID,
	OPERATING_UNIT_ORG_ID,
	ORDER_STATUS_ID,
	PAYMENT_METHOD_ID,
	PAYMENT_TERMS_ID,
	PLANT_LOC_ID,
	PRODUCT_ID,
	SALES_ORG_ID,
	SALES_PRODUCT_ID,
	SALES_REP_ID,
	TERR_ID,
	XACT_TYPE_ID,
	ORDER_SOURCE_ID,
	PROJECT_ID,
	TASK_ID,
	BOOKED_ON_DT,
	ENTERED_ON_DT,
	ORDER_ACKNOWLEDGED_DT,
	ORDERED_ON_DT,
	PROMISED_ON_DT,
	REQUIRED_BY_DT,
	COST_AMT,
	NET_AMT,
	LIST_AMT,
	DISCOUNT_AMT,
	SALES_QTY,
	ORDERED_QTY,
	CANCELLED_QTY,
	TOTAL_SHIPPED_QTY,
	TOTAL_INVOICED_QTY,
	SALES_UOM_CODE,
	SALES_ORDER_NUM,
	SALES_ORDER_ITEM,
	SALES_ORDER_ITEM_DETAIL_NUM,
	REF_DOC_NUM,
	PURCH_ORDER_NUM,
	ITEM_TYPE_CODE,
	SERVICE_FLG,
	PARTIAL_SHIPMENTS_ALLOWED_FLG,
	BOOKING_FLG,
	FULFILLED_FLG,
	FIN_BACKLOG_FLG,
	SCHEDULED_FLG,
	OPR_BACKLOG_FLG,
	SHIPPABLE_FLG,
	BILLING_FLG,
	INVOICE_INTERFACED_FLG,
	SHIPPING_INTERFACED_FLG,
	SALES_ORDER_HD_ID,
	SALES_ORDER_LN_ID,
	BOOKING_ID,
	DOC_CURR_CODE,
	LOC_CURR_CODE,
	LOC_EXCHANGE_RATE,
	EXCHANGE_DT,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	AUX1_CHANGED_ON_DT,
	AUX2_CHANGED_ON_DT,
	AUX3_CHANGED_ON_DT,
	AUX4_CHANGED_ON_DT,
	INTEGRATION_ID,
	X_PRICING_ATTRIBUTE28,
	X_SERVICE_START_DATE,
	X_SERVICE_END_DATE,
	X_SERVICE_REFERENCE_TYPE_CODE,
	X_SERVICE_REFERENCE_LINE_ID,
	X_LICENSE_ID,
	X_ORDER_SOURCE,
	X_SIMPLIFIED_CONTRACT_NUMBER,
	X_LENGTH_OF_CONTRACT,
	X_COVERED_INVENTORY_ITEM_ID,
	X_SOB_ID,
	X_SOB_CURRENCY_CODE,
	X_ALLOCATED_AMOUNT,
	X_CREDIT_PERCENTAGE,
	X_ORDER_TYPE,
	X_QUOTE_NUMBER,
	X_PROJECT_NAME,
	X_TARGET_OS,
	X_TYPE_OF_SERVICE,
	X_LICENSE_APP_CODE,
	X_SERVICE_LINE_DIRECTOR,
	X_SALES_CREDIT_ID,
	X_LINE_STATUS,
	X_SALES_CHANNEL_CODE,
	X_CREDIT_TYPE_CODE,
	X_BILL_TO_CUSTOMER_ID,
	X_SHIP_TO_CUSTOMER_ID,
	X_SOLD_TO_CUSTOMER_ID,
	X_ORDER_STATUS,
	X_SALESREP_ID,
	X_INV_NUMBER,
	X_INV_LINE_NUM,
	X_INV_DT,
	X_SALES_SPLIT_LINE_WID,
	X_TASK_NAME,
	X_REVN_TYPE_PRODUCT_ID,
	X_PS_PRODUCT_GROUP,
	X_PS_BUSINESS_UNIT,
	X_PS_REV_TYPE,
	X_PS_PRODUCT_UNIT,
	X_CONTRACT_START_DATE,
	X_CONTRACT_END_DATE,
	X_PROJECT_MANAGER,
	X_INTERFACE_LINE_ATTRIBUTE6,
	X_CUSTOMER_TRX_ID,
	X_CUSTOMER_TRX_LINE_ID,
	X_PR_CUSTOMER_TRX_LINE_ID,
	AUX6_CHANGED_ON_DT,
	AUX7_CHANGED_ON_DT,
	AUX8_CHANGED_ON_DT,
	AUX9_CHANGED_ON_DT,
	AUX10_CHANGED_ON_DT,
	AUX5_CHANGED_ON_DT,
	X_GROUP_LINE_NUM,
	X_ATTRIBUTE_CATEGORY,
	X_ATTRIBUTE2,
	X_ATTRIBUTE3,
	X_ATTRIBUTE4
	
FROM (	


select 	
	
	C1_CHNL_TYPE_ID CHNL_TYPE_ID,
	C2_CUSTOMER_BILL_TO_LOC_ID CUSTOMER_BILL_TO_LOC_ID,
	LKP_PARTY_CNTCT_CUST_CNTCT_ID.CONTACT_PARTY_ID CUSTOMER_CNTCT_ID,
	C3_CUSTOMER_SHIP_TO_LOC_ID CUSTOMER_SHIP_TO_LOC_ID,
	C4_CUSTOMER_ACCOUNT_ID CUSTOMER_ACCOUNT_ID,
	C5_FREIGHT_TERMS_ID FREIGHT_TERMS_ID,
	C6_INVENTORY_ORG_ID INVENTORY_ORG_ID,
	C7_INVENTORY_PRODUCT_ID INVENTORY_PRODUCT_ID,
	C8_OPERATING_UNIT_ORG_ID OPERATING_UNIT_ORG_ID,
	C9_ORDER_STATUS_ID ORDER_STATUS_ID,
	C10_PAYMENT_METHOD_ID PAYMENT_METHOD_ID,
	C11_PAYMENT_TERMS_ID PAYMENT_TERMS_ID,
	C12_PLANT_LOC_ID PLANT_LOC_ID,
	C13_PRODUCT_ID PRODUCT_ID,
	C14_SALES_ORG_ID SALES_ORG_ID,
	C15_SALES_PRODUCT_ID SALES_PRODUCT_ID,
	C16_SALES_REP_ID SALES_REP_ID,
	TO_CHAR(LKP_W_CUST_LOC_USE_D_SHIP_ID.TERRITORY_ID) TERR_ID,
	C17_XACT_TYPE_ID XACT_TYPE_ID,
	C18_ORDER_SOURCE_ID ORDER_SOURCE_ID,
	C19_PROJECT_ID PROJECT_ID,
	C20_TASK_ID TASK_ID,
	C21_BOOKED_ON_DT BOOKED_ON_DT,
	C22_ENTERED_ON_DT ENTERED_ON_DT,
	C23_ORDER_ACKNOWLEDGED_DT ORDER_ACKNOWLEDGED_DT,
	C24_ORDERED_ON_DT ORDERED_ON_DT,
	C25_PROMISED_ON_DT PROMISED_ON_DT,
	C26_REQUIRED_BY_DT REQUIRED_BY_DT,
	C27_COST_AMT COST_AMT,
	C28_NET_AMT NET_AMT,
	C29_LIST_AMT LIST_AMT,
	C30_DISCOUNT_AMT DISCOUNT_AMT,
	C31_SALES_QTY SALES_QTY,
	C32_ORDERED_QTY ORDERED_QTY,
	C33_CANCELLED_QTY CANCELLED_QTY,
	C34_TOTAL_SHIPPED_QTY TOTAL_SHIPPED_QTY,
	C35_TOTAL_INVOICED_QTY TOTAL_INVOICED_QTY,
	C36_SALES_UOM_CODE SALES_UOM_CODE,
	C37_SALES_ORDER_NUM SALES_ORDER_NUM,
	C38_SALES_ORDER_ITEM SALES_ORDER_ITEM,
	C39_SALES_ORDER_ITEM_DETAIL_NU SALES_ORDER_ITEM_DETAIL_NUM,
	C40_REF_DOC_NUM REF_DOC_NUM,
	C41_PURCH_ORDER_NUM PURCH_ORDER_NUM,
	C42_ITEM_TYPE_CODE ITEM_TYPE_CODE,
	C43_SERVICE_FLG SERVICE_FLG,
	C44_PARTIAL_SHIPMENTS_ALLOWED_ PARTIAL_SHIPMENTS_ALLOWED_FLG,
	C45_BOOKING_FLG BOOKING_FLG,
	C46_FULFILLED_FLG FULFILLED_FLG,
	C47_FIN_BACKLOG_FLG FIN_BACKLOG_FLG,
	C48_SCHEDULED_FLG SCHEDULED_FLG,
	C49_OPR_BACKLOG_FLG OPR_BACKLOG_FLG,
	C50_SHIPPABLE_FLG SHIPPABLE_FLG,
	C51_BILLING_FLG BILLING_FLG,
	C52_INVOICE_INTERFACED_FLG INVOICE_INTERFACED_FLG,
	C53_SHIPPING_INTERFACED_FLG SHIPPING_INTERFACED_FLG,
	C54_SALES_ORDER_HD_ID SALES_ORDER_HD_ID,
	C55_SALES_ORDER_LN_ID SALES_ORDER_LN_ID,
	C56_BOOKING_ID BOOKING_ID,
	C57_DOC_CURR_CODE DOC_CURR_CODE,
	LKP_W_LOC_CURR_CODE_TMP.LOC_CURR_CODE LOC_CURR_CODE,
	C58_LOC_EXCHANGE_RATE LOC_EXCHANGE_RATE,
	C59_EXCHANGE_DT EXCHANGE_DT,
	C60_CREATED_BY_ID CREATED_BY_ID,
	C61_CHANGED_BY_ID CHANGED_BY_ID,
	C62_CREATED_ON_DT CREATED_ON_DT,
	C63_CHANGED_ON_DT CHANGED_ON_DT,
	C64_AUX1_CHANGED_ON_DT AUX1_CHANGED_ON_DT,
	C65_AUX2_CHANGED_ON_DT AUX2_CHANGED_ON_DT,
	C66_AUX3_CHANGED_ON_DT AUX3_CHANGED_ON_DT,
	C67_AUX4_CHANGED_ON_DT AUX4_CHANGED_ON_DT,
	C68_INTEGRATION_ID INTEGRATION_ID,
	C69_X_PRICING_ATTRIBUTE28 X_PRICING_ATTRIBUTE28,
	C70_X_SERVICE_START_DATE X_SERVICE_START_DATE,
	C71_X_SERVICE_END_DATE X_SERVICE_END_DATE,
	C72_X_SERVICE_REFERENCE_TYPE_C X_SERVICE_REFERENCE_TYPE_CODE,
	C73_X_SERVICE_REFERENCE_LINE_I X_SERVICE_REFERENCE_LINE_ID,
	C74_X_LICENSE_ID X_LICENSE_ID,
	C75_X_ORDER_SOURCE X_ORDER_SOURCE,
	C76_X_SIMPLIFIED_CONTRACT_NUMB X_SIMPLIFIED_CONTRACT_NUMBER,
	C77_X_LENGTH_OF_CONTRACT X_LENGTH_OF_CONTRACT,
	C78_X_COVERED_INVENTORY_ITEM_I X_COVERED_INVENTORY_ITEM_ID,
	C79_X_SOB_ID X_SOB_ID,
	C80_X_SOB_CURRENCY_CODE X_SOB_CURRENCY_CODE,
	C81_X_ALLOCATED_AMOUNT X_ALLOCATED_AMOUNT,
	C82_X_CREDIT_PERCENTAGE X_CREDIT_PERCENTAGE,
	C83_X_ORDER_TYPE X_ORDER_TYPE,
	C84_X_QUOTE_NUMBER X_QUOTE_NUMBER,
	C85_X_PROJECT_NAME X_PROJECT_NAME,
	C86_X_TARGET_OS X_TARGET_OS,
	C87_X_TYPE_OF_SERVICE X_TYPE_OF_SERVICE,
	C88_X_LICENSE_APP_CODE X_LICENSE_APP_CODE,
	C89_X_SERVICE_LINE_DIRECTOR X_SERVICE_LINE_DIRECTOR,
	C90_X_SALES_CREDIT_ID X_SALES_CREDIT_ID,
	C91_X_LINE_STATUS X_LINE_STATUS,
	C92_X_SALES_CHANNEL_CODE X_SALES_CHANNEL_CODE,
	C93_X_CREDIT_TYPE_CODE X_CREDIT_TYPE_CODE,
	C94_X_BILL_TO_CUSTOMER_ID X_BILL_TO_CUSTOMER_ID,
	C95_X_SHIP_TO_CUSTOMER_ID X_SHIP_TO_CUSTOMER_ID,
	C96_X_SOLD_TO_CUSTOMER_ID X_SOLD_TO_CUSTOMER_ID,
	C97_X_ORDER_STATUS X_ORDER_STATUS,
	C98_X_SALESREP_ID X_SALESREP_ID,
	C99_X_INV_NUMBER X_INV_NUMBER,
	C100_X_INV_LINE_NUM X_INV_LINE_NUM,
	C101_X_INV_DT X_INV_DT,
	C102_X_SALES_SPLIT_LINE_WID X_SALES_SPLIT_LINE_WID,
	C103_X_TASK_NAME X_TASK_NAME,
	C104_X_REVN_TYPE_PRODUCT_ID X_REVN_TYPE_PRODUCT_ID,
	C105_X_PS_PRODUCT_GROUP X_PS_PRODUCT_GROUP,
	C106_X_PS_BUSINESS_UNIT X_PS_BUSINESS_UNIT,
	C107_X_PS_REV_TYPE X_PS_REV_TYPE,
	C108_X_PS_PRODUCT_UNIT X_PS_PRODUCT_UNIT,
	C109_X_CONTRACT_START_DATE X_CONTRACT_START_DATE,
	C110_X_CONTRACT_END_DATE X_CONTRACT_END_DATE,
	C111_X_PROJECT_MANAGER X_PROJECT_MANAGER,
	C112_X_INTERFACE_LINE_ATTRIBUT X_INTERFACE_LINE_ATTRIBUTE6,
	C113_X_CUSTOMER_TRX_ID X_CUSTOMER_TRX_ID,
	C114_X_CUSTOMER_TRX_LINE_ID X_CUSTOMER_TRX_LINE_ID,
	C115_X_PR_CUSTOMER_TRX_LINE_ID X_PR_CUSTOMER_TRX_LINE_ID,
	C116_AUX6_CHANGED_ON_DT AUX6_CHANGED_ON_DT,
	C117_AUX7_CHANGED_ON_DT AUX7_CHANGED_ON_DT,
	C118_AUX8_CHANGED_ON_DT AUX8_CHANGED_ON_DT,
	C119_AUX9_CHANGED_ON_DT AUX9_CHANGED_ON_DT,
	C120_AUX10_CHANGED_ON_DT AUX10_CHANGED_ON_DT,
	C121_AUX5_CHANGED_ON_DT AUX5_CHANGED_ON_DT,
	C122_X_GROUP_LINE_NUM X_GROUP_LINE_NUM,
	C123_X_ATTRIBUTE_CATEGORY X_ATTRIBUTE_CATEGORY,
	C124_X_ATTRIBUTE2 X_ATTRIBUTE2,
	C125_X_ATTRIBUTE3 X_ATTRIBUTE3,
	C126_X_ATTRIBUTE4 X_ATTRIBUTE4 
from	((SALES_ORDER_PA   LEFT OUTER JOIN 
( /* Subselect from LKP_PARTY_CONTACT_CUST_CONTACT_ID
*/


select 
	   

	   
	   W_ORA_PARTY_CONTACT_PS.CONTACT_PARTY_ID CONTACT_PARTY_ID,
	W_ORA_PARTY_CONTACT_PS.CUST_ACCOUNT_ROLE_ID CUST_ACCOUNT_ROLE_ID,
	W_ORA_PARTY_CONTACT_PS.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	DECODE(ROW_NUMBER() OVER (PARTITION BY 
	W_ORA_PARTY_CONTACT_PS.CUST_ACCOUNT_ROLE_ID,W_ORA_PARTY_CONTACT_PS.DATASOURCE_NUM_ID ORDER BY 
	W_ORA_PARTY_CONTACT_PS.CONTACT_PARTY_ID
),1,1,0) LKP_ACTIVE
from	"PC_FIVETRAN_DB"."OBIEE_DW"."W_ORA_PARTY_CONTACT_PS"   W_ORA_PARTY_CONTACT_PS
where	(1=1)

And (W_ORA_PARTY_CONTACT_PS.CUST_ACCOUNT_ROLE_ID>0)







)    LKP_PARTY_CNTCT_CUST_CNTCT_ID ON TO_CHAR(C127_SOLD_TO_CONTACT_ID) = LKP_PARTY_CNTCT_CUST_CNTCT_ID.CUST_ACCOUNT_ROLE_ID
AND 380 = LKP_PARTY_CNTCT_CUST_CNTCT_ID.DATASOURCE_NUM_ID) LEFT OUTER JOIN 
( /* Subselect from LKP_W_CUSTOMER_LOC_USE_D_GET_SHIP_TO_IDS
*/


select 
	   

	   
	   W_CUSTOMER_LOC_USE_D.ACCT_SITE_ID ACCT_SITE_ID,
	W_CUSTOMER_LOC_USE_D.CUSTOMER_ID CUSTOMER_ID,
	W_CUSTOMER_LOC_USE_D.TERRITORY_ID TERRITORY_ID,
	W_CUSTOMER_LOC_USE_D.SITE_USE_ID SITE_USE_ID,
	W_CUSTOMER_LOC_USE_D.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	W_CUSTOMER_LOC_USE_D.EFFECTIVE_FROM_DT EFFECTIVE_FROM_DT,
	W_CUSTOMER_LOC_USE_D.EFFECTIVE_TO_DT EFFECTIVE_TO_DT,
	DECODE(ROW_NUMBER() OVER (PARTITION BY 
	W_CUSTOMER_LOC_USE_D.SITE_USE_ID,W_CUSTOMER_LOC_USE_D.DATASOURCE_NUM_ID ORDER BY 
	
		W_CUSTOMER_LOC_USE_D.EFFECTIVE_FROM_DT,
		W_CUSTOMER_LOC_USE_D.EFFECTIVE_TO_DT,
		W_CUSTOMER_LOC_USE_D.ACCT_SITE_ID,
		W_CUSTOMER_LOC_USE_D.CUSTOMER_ID
	   ,W_CUSTOMER_LOC_USE_D.TERRITORY_ID
	
),1,1,0) LKP_ACTIVE
from	"PC_FIVETRAN_DB"."OBIEE_DW"."W_CUSTOMER_LOC_USE_D"    W_CUSTOMER_LOC_USE_D
where	(1=1)

And (W_CUSTOMER_LOC_USE_D.SITE_USE_CODE='SHIP_TO')







)    LKP_W_CUST_LOC_USE_D_SHIP_ID ON TO_CHAR(C128_SHIP_TO_ORG_ID) =LKP_W_CUST_LOC_USE_D_SHIP_ID.SITE_USE_ID
AND	380 =LKP_W_CUST_LOC_USE_D_SHIP_ID.DATASOURCE_NUM_ID
AND	C62_CREATED_ON_DT >=LKP_W_CUST_LOC_USE_D_SHIP_ID.EFFECTIVE_FROM_DT
AND	C62_CREATED_ON_DT <LKP_W_CUST_LOC_USE_D_SHIP_ID.EFFECTIVE_TO_DT) LEFT OUTER JOIN "PC_FIVETRAN_DB"."OBIEE_DW"."W_LOC_CURR_CODE_TMP"    LKP_W_LOC_CURR_CODE_TMP ON TO_CHAR(C129_X_SET_OF_BOOKS_ID)= LKP_W_LOC_CURR_CODE_TMP.INTEGRATION_ID
AND	380 = LKP_W_LOC_CURR_CODE_TMP.DATASOURCE_NUM_ID
where		(1=1)	






)    ODI_GET_FROM
)

SELECT * FROM SALES_ORDER_PA_TOTAL
