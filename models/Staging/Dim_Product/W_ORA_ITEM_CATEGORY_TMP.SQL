 WITH ITEM_CATEGORY_TMP AS
 (select	
	
	SQ_W_ORA_ITEM_CATEGORY_TMP.CATEGORY_ID	   C1_CATEGORY_ID,
	SQ_W_ORA_ITEM_CATEGORY_TMP.CATEGORY_SET_ID	   C2_CATEGORY_SET_ID,
	SQ_W_ORA_ITEM_CATEGORY_TMP.INVENTORY_ITEM_ID	   C3_INVENTORY_ITEM_ID,
	SQ_W_ORA_ITEM_CATEGORY_TMP.ORGANIZATION_ID	   C4_ORGANIZATION_ID,
	TO_CHAR(SQ_W_ORA_ITEM_CATEGORY_TMP.CATEGORY_SET_ID) ||'~'|| TO_CHAR(SQ_W_ORA_ITEM_CATEGORY_TMP.CATEGORY_ID)	   C5_INTEGRATION_ID,
	TO_CHAR(SQ_W_ORA_ITEM_CATEGORY_TMP.INVENTORY_ITEM_ID)	   C6_CHAR_INVENTORY_ITEM_ID,
	SQ_W_ORA_ITEM_CATEGORY_TMP.CREATED_BY_ID	   C7_CREATED_BY_ID,
	SQ_W_ORA_ITEM_CATEGORY_TMP.CHANGED_BY_ID	   C8_CHANGED_BY_ID,
	SQ_W_ORA_ITEM_CATEGORY_TMP.CREATED_ON_DT	   C9_CREATED_ON_DT,
	SQ_W_ORA_ITEM_CATEGORY_TMP.CHANGED_ON_DT	   C10_CHANGED_ON_DT,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment1	   C11_X_SEGMENT1,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment2	   C12_X_SEGMENT2,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment3	   C13_X_SEGMENT3,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment4	   C14_X_SEGMENT4,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment5	   C15_X_SEGMENT5,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment6	   C16_X_SEGMENT6,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment7	   C17_X_SEGMENT7,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment8	   C18_X_SEGMENT8,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment9	   C19_X_SEGMENT9,
	SQ_W_ORA_ITEM_CATEGORY_TMP.segment10	   C20_X_SEGMENT10,
	SQ_W_ORA_ITEM_CATEGORY_TMP.CATEGORY_UPDATE_DATE	   C21_X_CATEGORY_UPDATE_DATE
from	
( /* Subselect from SDE_ORA_ProductDimension_Categories_Derive.W_ORA_ITEM_CATEGORY_TMP_SQ_Derive
*/


select 
	   

	   
	   MTL_ITEM_CATEGORIES.CATEGORY_ID CATEGORY_ID,
	MTL_ITEM_CATEGORIES.CATEGORY_SET_ID CATEGORY_SET_ID,
	MTL_ITEM_CATEGORIES.INVENTORY_ITEM_ID INVENTORY_ITEM_ID,
	MTL_ITEM_CATEGORIES.ORGANIZATION_ID ORGANIZATION_ID,
	MTL_ITEM_CATEGORIES.CREATED_BY CREATED_BY_ID,
	MTL_ITEM_CATEGORIES.LAST_UPDATED_BY CHANGED_BY_ID,
	MTL_ITEM_CATEGORIES.CREATION_DATE CREATED_ON_DT,
	
 MTL_ITEM_CATEGORIES.LAST_UPDATE_DATE
 CHANGED_ON_DT,
	
'N'
 DELETE_FLG,
	MTL_CATEGORIES_B.SEGMENT1 segment1,
	MTL_CATEGORIES_B.SEGMENT2 segment2,
	MTL_CATEGORIES_B.SEGMENT3 segment3,
	MTL_CATEGORIES_B.SEGMENT4 segment4,
	MTL_CATEGORIES_B.SEGMENT5 segment5,
	MTL_CATEGORIES_B.SEGMENT6 segment6,
	MTL_CATEGORIES_B.SEGMENT7 segment7,
	MTL_CATEGORIES_B.SEGMENT8 segment8,
	MTL_CATEGORIES_B.SEGMENT9 segment9,
	MTL_CATEGORIES_B.SEGMENT10 segment10,
	MTL_ITEM_CATEGORIES.LAST_UPDATE_DATE CATEGORY_UPDATE_DATE
from	"PC_FIVETRAN_DB"."ERPPRD_INV"."MTL_ITEM_CATEGORIES"
  MTL_ITEM_CATEGORIES, "PC_FIVETRAN_DB"."ERPPRD_INV"."MTL_CATEGORIES_B"
   MTL_CATEGORIES_B
where	(1=1)
 And (MTL_ITEM_CATEGORIES.CATEGORY_ID=MTL_CATEGORIES_B.CATEGORY_ID (+))

And (MTL_ITEM_CATEGORIES.CATEGORY_SET_ID IN (1100000006,1100000022,1100000002,1100000003,1100000005,0,0,0,0,0))
 And (MTL_ITEM_CATEGORIES.ORGANIZATION_ID IN ('307'))







)   SQ_W_ORA_ITEM_CATEGORY_TMP
where	(1=1)
),
  
  ITEM_CATEGORY_TMP_TOTAL AS
(

select	
	CATEGORY_ID,
	CATEGORY_SET_ID,
	INVENTORY_ITEM_ID,
	ORGANIZATION_ID,
	INTEGRATION_ID,
	CHAR_INVENTORY_ITEM_ID,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	X_SEGMENT1,
	X_SEGMENT2,
	X_SEGMENT3,
	X_SEGMENT4,
	X_SEGMENT5,
	X_SEGMENT6,
	X_SEGMENT7,
	X_SEGMENT8,
	X_SEGMENT9,
	X_SEGMENT10,
	X_CATEGORY_UPDATE_DATE
	,380 DATASOURCE_NUM_ID,
	141840 ETL_PROC_WID,
	CURRENT_DATE W_INSERT_DT
FROM (	


select 	
	
	C1_CATEGORY_ID CATEGORY_ID,
	C2_CATEGORY_SET_ID CATEGORY_SET_ID,
	C3_INVENTORY_ITEM_ID INVENTORY_ITEM_ID,
	C4_ORGANIZATION_ID ORGANIZATION_ID,
	C5_INTEGRATION_ID INTEGRATION_ID,
	C6_CHAR_INVENTORY_ITEM_ID CHAR_INVENTORY_ITEM_ID,
	C7_CREATED_BY_ID CREATED_BY_ID,
	C8_CHANGED_BY_ID CHANGED_BY_ID,
	C9_CREATED_ON_DT CREATED_ON_DT,
	C10_CHANGED_ON_DT CHANGED_ON_DT,
	C11_X_SEGMENT1 X_SEGMENT1,
	C12_X_SEGMENT2 X_SEGMENT2,
	C13_X_SEGMENT3 X_SEGMENT3,
	C14_X_SEGMENT4 X_SEGMENT4,
	C15_X_SEGMENT5 X_SEGMENT5,
	C16_X_SEGMENT6 X_SEGMENT6,
	C17_X_SEGMENT7 X_SEGMENT7,
	C18_X_SEGMENT8 X_SEGMENT8,
	C19_X_SEGMENT9 X_SEGMENT9,
	C20_X_SEGMENT10 X_SEGMENT10,
	C21_X_CATEGORY_UPDATE_DATE X_CATEGORY_UPDATE_DATE 
from	ITEM_CATEGORY_TMP
where		(1=1)	

)    ODI_GET_FROM
)
SELECT * FROM ITEM_CATEGORY_TMP_TOTAL
