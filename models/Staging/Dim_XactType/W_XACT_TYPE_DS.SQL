{{ config (
    materialized="table"
)}}
WITH W_XACT_TYPE_DS_TMP AS
(
select	
	
	SQ_RA_CUST_TRX_TYPES.TYPE	   XACT_TYPE_CODE,
	SQ_RA_CUST_TRX_TYPES.DESCRIPTIVE_FLEX_CONTEXT_CODE	   XACT_TYPE_CODE1,
	SQ_RA_CUST_TRX_TYPES.NAME	   XACT_SUBTYPE_CODE,
	SQ_RA_CUST_TRX_TYPES.DESCRIPTIVE_FLEX_CONTEXT_CODE	   W_XACT_TYPE_CODE1,
	TO_CHAR(SQ_RA_CUST_TRX_TYPES.CREATED_BY)	   CREATED_BY_ID,
	TO_CHAR(SQ_RA_CUST_TRX_TYPES.LAST_UPDATED_BY)	CHANGED_BY_ID,
	SQ_RA_CUST_TRX_TYPES.CREATION_DATE	  CREATED_ON_DT,
	SQ_RA_CUST_TRX_TYPES.LAST_UPDATE_DATE	   CHANGED_ON_DT,
	'SALES_IVCLNS' ||'~'||TO_CHAR(SQ_RA_CUST_TRX_TYPES.CUST_TRX_TYPE_ID) ||'~'||TO_CHAR(SQ_RA_CUST_TRX_TYPES.ORG_ID)||'~'||SQ_RA_CUST_TRX_TYPES.DESCRIPTIVE_FLEX_CONTEXT_CODE	   INTEGRATION_ID,
	SQ_RA_CUST_TRX_TYPES.X_CUSTOM	   X_CUSTOM
from	
( /* Subselect from SDE_ORA_TransactionTypeDimension_SalesInvoiceLines.W_XACT_TYPE_DS_TMP
*/


SELECT RA_CUST_TRX_TYPES_ALL.NAME, RA_CUST_TRX_TYPES_ALL.DESCRIPTION,
 RA_CUST_TRX_TYPES_ALL.CUST_TRX_TYPE_ID, RA_CUST_TRX_TYPES_ALL.ORG_ID,
 RA_CUST_TRX_TYPES_ALL.CREATION_DATE, RA_CUST_TRX_TYPES_ALL.LAST_UPDATE_DATE,
 RA_CUST_TRX_TYPES_ALL.CREATED_BY, RA_CUST_TRX_TYPES_ALL.LAST_UPDATED_BY,

RA_CUST_TRX_TYPES_ALL.TYPE,

B.DESCRIPTIVE_FLEX_CONTEXT_CODE ,   

T.DESCRIPTIVE_FLEX_CONTEXT_NAME, 

T.DESCRIPTION ,
'0' X_CUSTOM

FROM

"PC_FIVETRAN_DB"."ERPPRD1_AR"."RA_CUST_TRX_TYPES_ALL" RA_CUST_TRX_TYPES_ALL,

"PC_FIVETRAN_DB"."ERPPRD1_APPLSYS"."FND_DESCR_FLEX_CONTEXTS_TL" T, 

"PC_FIVETRAN_DB"."ERPPRD1_APPLSYS"."FND_DESCR_FLEX_CONTEXTS" B

WHERE

B.APPLICATION_ID = T.APPLICATION_ID AND

B.DESCRIPTIVE_FLEXFIELD_NAME = T.DESCRIPTIVE_FLEXFIELD_NAME AND

B.DESCRIPTIVE_FLEX_CONTEXT_CODE = T.DESCRIPTIVE_FLEX_CONTEXT_CODE AND 

B.DESCRIPTIVE_FLEXFIELD_NAME = 'RA_INTERFACE_LINES' AND

T.LANGUAGE = 'US' AND B.APPLICATION_ID=222

UNION ALL

SELECT RA_CUST_TRX_TYPES_ALL.NAME, RA_CUST_TRX_TYPES_ALL.DESCRIPTION, RA_CUST_TRX_TYPES_ALL.CUST_TRX_TYPE_ID, 
RA_CUST_TRX_TYPES_ALL.ORG_ID, RA_CUST_TRX_TYPES_ALL.CREATION_DATE, RA_CUST_TRX_TYPES_ALL.LAST_UPDATE_DATE,
RA_CUST_TRX_TYPES_ALL.CREATED_BY, RA_CUST_TRX_TYPES_ALL.LAST_UPDATED_BY,

RA_CUST_TRX_TYPES_ALL.TYPE,

NULL ,   

NULL, 

NULL,
'0' X_CUSTOM

FROM

"PC_FIVETRAN_DB"."ERPPRD1_AR"."RA_CUST_TRX_TYPES_ALL" RA_CUST_TRX_TYPES_ALL

)   SQ_RA_CUST_TRX_TYPES
where	(1=1)
union all
select	
	
	SQ_RA_CUST_TRX_TYPES.TYPE	   XACT_TYPE_CODE,
	SQ_RA_CUST_TRX_TYPES.DESCRIPTIVE_FLEX_CONTEXT_CODE	   XACT_TYPE_CODE1,
	SQ_RA_CUST_TRX_TYPES.NAME	   XACT_SUBTYPE_CODE,
	SQ_RA_CUST_TRX_TYPES.DESCRIPTIVE_FLEX_CONTEXT_CODE	   W_XACT_TYPE_CODE1,
	TO_CHAR(SQ_RA_CUST_TRX_TYPES.CREATED_BY)	   CREATED_BY_ID,
	TO_CHAR(SQ_RA_CUST_TRX_TYPES.LAST_UPDATED_BY)	CHANGED_BY_ID,
	SQ_RA_CUST_TRX_TYPES.CREATION_DATE	  CREATED_ON_DT,
	SQ_RA_CUST_TRX_TYPES.LAST_UPDATE_DATE	   CHANGED_ON_DT,
	'SALES_IVCLNS' ||'~'||TO_CHAR(SQ_RA_CUST_TRX_TYPES.CUST_TRX_TYPE_ID) ||'~'||TO_CHAR(SQ_RA_CUST_TRX_TYPES.ORG_ID)||'~'||SQ_RA_CUST_TRX_TYPES.DESCRIPTIVE_FLEX_CONTEXT_CODE	   INTEGRATION_ID,
	SQ_RA_CUST_TRX_TYPES.X_CUSTOM	   X_CUSTOM
from	
( /* Subselect from SDE_ORA_TransactionTypeDimension_SalesInvoiceLines.W_XACT_TYPE_DS_TMP
*/


SELECT RA_CUST_TRX_TYPES_ALL.NAME, RA_CUST_TRX_TYPES_ALL.DESCRIPTION,
 RA_CUST_TRX_TYPES_ALL.CUST_TRX_TYPE_ID, RA_CUST_TRX_TYPES_ALL.ORG_ID,
 RA_CUST_TRX_TYPES_ALL.CREATION_DATE, RA_CUST_TRX_TYPES_ALL.LAST_UPDATE_DATE,
 RA_CUST_TRX_TYPES_ALL.CREATED_BY, RA_CUST_TRX_TYPES_ALL.LAST_UPDATED_BY,

RA_CUST_TRX_TYPES_ALL.TYPE,

B.DESCRIPTIVE_FLEX_CONTEXT_CODE ,   

T.DESCRIPTIVE_FLEX_CONTEXT_NAME, 

T.DESCRIPTION ,
'0' X_CUSTOM

FROM

"PC_FIVETRAN_DB"."ERPPRD1_AR"."RA_CUST_TRX_TYPES_ALL" RA_CUST_TRX_TYPES_ALL,

"PC_FIVETRAN_DB"."ERPPRD1_APPLSYS"."FND_DESCR_FLEX_CONTEXTS_TL" T, 

"PC_FIVETRAN_DB"."ERPPRD1_APPLSYS"."FND_DESCR_FLEX_CONTEXTS" B

WHERE

B.APPLICATION_ID = T.APPLICATION_ID AND

B.DESCRIPTIVE_FLEXFIELD_NAME = T.DESCRIPTIVE_FLEXFIELD_NAME AND

B.DESCRIPTIVE_FLEX_CONTEXT_CODE = T.DESCRIPTIVE_FLEX_CONTEXT_CODE AND 

B.DESCRIPTIVE_FLEXFIELD_NAME = 'RA_INTERFACE_LINES' AND

T.LANGUAGE = 'US' AND B.APPLICATION_ID=222

UNION ALL

SELECT RA_CUST_TRX_TYPES_ALL.NAME, RA_CUST_TRX_TYPES_ALL.DESCRIPTION, RA_CUST_TRX_TYPES_ALL.CUST_TRX_TYPE_ID, 
RA_CUST_TRX_TYPES_ALL.ORG_ID, RA_CUST_TRX_TYPES_ALL.CREATION_DATE, RA_CUST_TRX_TYPES_ALL.LAST_UPDATE_DATE,
RA_CUST_TRX_TYPES_ALL.CREATED_BY, RA_CUST_TRX_TYPES_ALL.LAST_UPDATED_BY,

RA_CUST_TRX_TYPES_ALL.TYPE,

NULL ,   

NULL, 

NULL,
'0' X_CUSTOM

FROM

"PC_FIVETRAN_DB"."ERPPRD1_AR"."RA_CUST_TRX_TYPES_ALL" RA_CUST_TRX_TYPES_ALL

)   SQ_RA_CUST_TRX_TYPES
where	(1=1)
)

SELECT * FROM W_XACT_TYPE_DS_TMP






 

