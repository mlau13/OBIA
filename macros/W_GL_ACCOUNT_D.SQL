{% macro W_GL_ACCOUNT_D() %}
--To Do -- Clean up added records that are no longer needed

  {% set sql %}
  
  --Delete inserted records

delete from OBIEE_DW.W_GL_ACCOUNT_D where INTEGRATION_ID in(
select 	
	TARGET_TABLE.INTEGRATION_ID INTEGRATION_ID 
from	"PC_FIVETRAN_DB"."OBIEE_DW"."W_GL_ACCOUNT_D"  TARGET_TABLE, "PC_FIVETRAN_DB"."OBIEE_DW"."W_GL_ACCOUNT_DS"    PE_STAGE_TABLE
where TARGET_TABLE.INTEGRATION_ID=PE_STAGE_TABLE.INTEGRATION_ID);


  --Inserts records that don't have actuals for a given day, but have a daily budget
    insert into OBIEE_DW.W_GL_ACCOUNT_D
(
CHART_OF_ACCOUNTS	,
CONCATENATED_SEGMENT_VALUE	,
BALANCING_SEGMENT_NUM	,
BALANCING_SEGMENT_ATTRIB	,
COST_CENTER_NUM	,
COST_CENTER_ATTRIB	,
NATURAL_ACCOUNT_NUM	,
NATURAL_ACCOUNT_ATTRIB	,
GROUP_ACCOUNT_NUM	,
RECON_TYPE_CODE	,
ACTIVE_FLG	,
ACCOUNT_SEG1_CODE	,
ACCOUNT_SEG1_ATTRIB	,
ACCOUNT_SEG1_INTEGRATION_ID	,
ACCOUNT_SEG2_CODE	,
ACCOUNT_SEG2_ATTRIB	,
ACCOUNT_SEG2_INTEGRATION_ID	,
ACCOUNT_SEG3_CODE	,
ACCOUNT_SEG3_ATTRIB	,
ACCOUNT_SEG3_INTEGRATION_ID	,
ACCOUNT_SEG4_CODE	,
ACCOUNT_SEG4_ATTRIB	,
ACCOUNT_SEG4_INTEGRATION_ID	,
ACCOUNT_SEG5_CODE	,
ACCOUNT_SEG5_ATTRIB	,
ACCOUNT_SEG5_INTEGRATION_ID	,
ACCOUNT_SEG6_CODE	,
ACCOUNT_SEG6_ATTRIB	,
ACCOUNT_SEG6_INTEGRATION_ID	,
ACCOUNT_SEG7_CODE	,
ACCOUNT_SEG7_ATTRIB	,
ACCOUNT_SEG7_INTEGRATION_ID	,
ACCOUNT_SEG8_CODE	,
ACCOUNT_SEG8_ATTRIB	,
ACCOUNT_SEG8_INTEGRATION_ID	,
ACCOUNT_SEG9_CODE	,
ACCOUNT_SEG9_ATTRIB	,
ACCOUNT_SEG9_INTEGRATION_ID	,
ACCOUNT_SEG10_CODE	,
ACCOUNT_SEG10_ATTRIB	,
ACCOUNT_SEG10_INTEGRATION_ID	,
ACCOUNT_SEG11_CODE	,
ACCOUNT_SEG11_ATTRIB	,
ACCOUNT_SEG11_INTEGRATION_ID	,
ACCOUNT_SEG12_CODE	,
ACCOUNT_SEG12_ATTRIB	,
ACCOUNT_SEG12_INTEGRATION_ID	,
ACCOUNT_SEG13_CODE	,
ACCOUNT_SEG13_ATTRIB	,
ACCOUNT_SEG13_INTEGRATION_ID	,
ACCOUNT_SEG14_CODE	,
ACCOUNT_SEG14_ATTRIB	,
ACCOUNT_SEG14_INTEGRATION_ID	,
ACCOUNT_SEG15_CODE	,
ACCOUNT_SEG15_ATTRIB	,
ACCOUNT_SEG15_INTEGRATION_ID	,
ACCOUNT_SEG16_CODE	,
ACCOUNT_SEG16_ATTRIB	,
ACCOUNT_SEG16_INTEGRATION_ID	,
ACCOUNT_SEG17_CODE	,
ACCOUNT_SEG17_ATTRIB	,
ACCOUNT_SEG17_INTEGRATION_ID	,
ACCOUNT_SEG18_CODE	,
ACCOUNT_SEG18_ATTRIB	,
ACCOUNT_SEG18_INTEGRATION_ID	,
ACCOUNT_SEG19_CODE	,
ACCOUNT_SEG19_ATTRIB	,
ACCOUNT_SEG19_INTEGRATION_ID	,
ACCOUNT_SEG20_CODE	,
ACCOUNT_SEG20_ATTRIB	,
ACCOUNT_SEG20_INTEGRATION_ID	,
ACCOUNT_SEG21_CODE	,
ACCOUNT_SEG21_ATTRIB	,
ACCOUNT_SEG21_INTEGRATION_ID	,
ACCOUNT_SEG22_CODE	,
ACCOUNT_SEG22_ATTRIB	,
ACCOUNT_SEG22_INTEGRATION_ID	,
ACCOUNT_SEG23_CODE	,
ACCOUNT_SEG23_ATTRIB	,
ACCOUNT_SEG23_INTEGRATION_ID	,
ACCOUNT_SEG24_CODE	,
ACCOUNT_SEG24_ATTRIB	,
ACCOUNT_SEG24_INTEGRATION_ID	,
ACCOUNT_SEG25_CODE	,
ACCOUNT_SEG25_ATTRIB	,
ACCOUNT_SEG25_INTEGRATION_ID	,
ACCOUNT_SEG26_CODE	,
ACCOUNT_SEG26_ATTRIB	,
ACCOUNT_SEG26_INTEGRATION_ID	,
ACCOUNT_SEG27_CODE	,
ACCOUNT_SEG27_ATTRIB	,
ACCOUNT_SEG27_INTEGRATION_ID	,
ACCOUNT_SEG28_CODE	,
ACCOUNT_SEG28_ATTRIB	,
ACCOUNT_SEG28_INTEGRATION_ID	,
ACCOUNT_SEG29_CODE	,
ACCOUNT_SEG29_ATTRIB	,
ACCOUNT_SEG29_INTEGRATION_ID	,
ACCOUNT_SEG30_CODE	,
ACCOUNT_SEG30_ATTRIB	,
ACCOUNT_SEG30_INTEGRATION_ID	,
CREATED_BY_ID	,
CHANGED_BY_ID	,
CREATED_ON_DT	,
CHANGED_ON_DT	,
AUX1_CHANGED_ON_DT	,
AUX2_CHANGED_ON_DT	,
AUX3_CHANGED_ON_DT	,
SRC_EFF_FROM_DT	,
DELETE_FLG	,
DATASOURCE_NUM_ID	,
INTEGRATION_ID	,
TENANT_ID	,
X_CUSTOM	,
PROJECT_CODE	,
PROJECT_ATTRIB	,
PROJECT_INTEGRATION_ID	,
PROGRAM_CODE	,
PROGRAM_ATTRIB	,
PROGRAM_INTEGRATION_ID	,
LAST_DATE		
)
select 
 CHART_OF_ACCOUNTS	,
CONCATENATED_SEGMENT_VALUE	,
BALANCING_SEGMENT_NUM	,
BALANCING_SEGMENT_ATTRIB	,
COST_CENTER_NUM	,
COST_CENTER_ATTRIB	,
NATURAL_ACCOUNT_NUM	,
NATURAL_ACCOUNT_ATTRIB	,
GROUP_ACCOUNT_NUM	,
RECON_TYPE_CODE	,
ACTIVE_FLG	,
ACCOUNT_SEG1_CODE	,
ACCOUNT_SEG1_ATTRIB	,
ACCOUNT_SEG1_INTEGRATION_ID	,
ACCOUNT_SEG2_CODE	,
ACCOUNT_SEG2_ATTRIB	,
ACCOUNT_SEG2_INTEGRATION_ID	,
ACCOUNT_SEG3_CODE	,
ACCOUNT_SEG3_ATTRIB	,
ACCOUNT_SEG3_INTEGRATION_ID	,
ACCOUNT_SEG4_CODE	,
ACCOUNT_SEG4_ATTRIB	,
ACCOUNT_SEG4_INTEGRATION_ID	,
ACCOUNT_SEG5_CODE	,
ACCOUNT_SEG5_ATTRIB	,
ACCOUNT_SEG5_INTEGRATION_ID	,
ACCOUNT_SEG6_CODE	,
ACCOUNT_SEG6_ATTRIB	,
ACCOUNT_SEG6_INTEGRATION_ID	,
ACCOUNT_SEG7_CODE	,
ACCOUNT_SEG7_ATTRIB	,
ACCOUNT_SEG7_INTEGRATION_ID	,
ACCOUNT_SEG8_CODE	,
ACCOUNT_SEG8_ATTRIB	,
ACCOUNT_SEG8_INTEGRATION_ID	,
ACCOUNT_SEG9_CODE	,
ACCOUNT_SEG9_ATTRIB	,
ACCOUNT_SEG9_INTEGRATION_ID	,
ACCOUNT_SEG10_CODE	,
ACCOUNT_SEG10_ATTRIB	,
ACCOUNT_SEG10_INTEGRATION_ID	,
ACCOUNT_SEG11_CODE	,
ACCOUNT_SEG11_ATTRIB	,
ACCOUNT_SEG11_INTEGRATION_ID	,
ACCOUNT_SEG12_CODE	,
ACCOUNT_SEG12_ATTRIB	,
ACCOUNT_SEG12_INTEGRATION_ID	,
ACCOUNT_SEG13_CODE	,
ACCOUNT_SEG13_ATTRIB	,
ACCOUNT_SEG13_INTEGRATION_ID	,
ACCOUNT_SEG14_CODE	,
ACCOUNT_SEG14_ATTRIB	,
ACCOUNT_SEG14_INTEGRATION_ID	,
ACCOUNT_SEG15_CODE	,
ACCOUNT_SEG15_ATTRIB	,
ACCOUNT_SEG15_INTEGRATION_ID	,
ACCOUNT_SEG16_CODE	,
ACCOUNT_SEG16_ATTRIB	,
ACCOUNT_SEG16_INTEGRATION_ID	,
ACCOUNT_SEG17_CODE	,
ACCOUNT_SEG17_ATTRIB	,
ACCOUNT_SEG17_INTEGRATION_ID	,
ACCOUNT_SEG18_CODE	,
ACCOUNT_SEG18_ATTRIB	,
ACCOUNT_SEG18_INTEGRATION_ID	,
ACCOUNT_SEG19_CODE	,
ACCOUNT_SEG19_ATTRIB	,
ACCOUNT_SEG19_INTEGRATION_ID	,
ACCOUNT_SEG20_CODE	,
ACCOUNT_SEG20_ATTRIB	,
ACCOUNT_SEG20_INTEGRATION_ID	,
ACCOUNT_SEG21_CODE	,
ACCOUNT_SEG21_ATTRIB	,
ACCOUNT_SEG21_INTEGRATION_ID	,
ACCOUNT_SEG22_CODE	,
ACCOUNT_SEG22_ATTRIB	,
ACCOUNT_SEG22_INTEGRATION_ID	,
ACCOUNT_SEG23_CODE	,
ACCOUNT_SEG23_ATTRIB	,
ACCOUNT_SEG23_INTEGRATION_ID	,
ACCOUNT_SEG24_CODE	,
ACCOUNT_SEG24_ATTRIB	,
ACCOUNT_SEG24_INTEGRATION_ID	,
ACCOUNT_SEG25_CODE	,
ACCOUNT_SEG25_ATTRIB	,
ACCOUNT_SEG25_INTEGRATION_ID	,
ACCOUNT_SEG26_CODE	,
ACCOUNT_SEG26_ATTRIB	,
ACCOUNT_SEG26_INTEGRATION_ID	,
ACCOUNT_SEG27_CODE	,
ACCOUNT_SEG27_ATTRIB	,
ACCOUNT_SEG27_INTEGRATION_ID	,
ACCOUNT_SEG28_CODE	,
ACCOUNT_SEG28_ATTRIB	,
ACCOUNT_SEG28_INTEGRATION_ID	,
ACCOUNT_SEG29_CODE	,
ACCOUNT_SEG29_ATTRIB	,
ACCOUNT_SEG29_INTEGRATION_ID	,
ACCOUNT_SEG30_CODE	,
ACCOUNT_SEG30_ATTRIB	,
ACCOUNT_SEG30_INTEGRATION_ID	,
CREATED_BY_ID	,
CHANGED_BY_ID	,
CREATED_ON_DT	,
CHANGED_ON_DT	,
AUX1_CHANGED_ON_DT	,
AUX2_CHANGED_ON_DT	,
AUX3_CHANGED_ON_DT	,
SRC_EFF_FROM_DT	,
DELETE_FLG	,
DATASOURCE_NUM_ID	,
INTEGRATION_ID	,
TENANT_ID	,
X_CUSTOM	,
PROJECT_CODE	,
PROJECT_ATTRIB	,
PROJECT_INTEGRATION_ID	,
PROGRAM_CODE	,
PROGRAM_ATTRIB	,
PROGRAM_INTEGRATION_ID	,
LAST_DATE	
from  OBIEE_DW.W_GL_ACCOUNT_DS;

{% endset %}

{% do run_query(sql) %}

{% do log("W_GL_ACCOUNT_D", info=True) %}

{% endmacro %}