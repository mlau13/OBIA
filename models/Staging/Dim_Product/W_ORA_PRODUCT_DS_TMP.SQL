  
WITH  PRODUCT_DS_TMP  AS
( 
	select	
	
	SQ_BCI_PRODUCTS.INVENTORY_ITEM_ID	   C1_INVENTORY_ITEM_ID,
	SQ_BCI_PRODUCTS.MASTER_ORGANIZATION_ID	   C2_ORGANIZATION_ID,
	COALESCE(SQ_BCI_PRODUCTS.ITEM_TYPE,'__UNASSIGNED__')	   C3_PRODUCT_TYPE_CODE,
	SQ_BCI_PRODUCTS.BASE_ITEM_ID	   C4_BASIC_PRODUCT,
	SQ_BCI_PRODUCTS.START_DATE_ACTIVE	   C5_INTRODUCTION_DT,
	CASE
WHEN SQ_BCI_PRODUCTS.PLANNING_MAKE_BUY_CODE=1 THEN 'M'
WHEN SQ_BCI_PRODUCTS.PLANNING_MAKE_BUY_CODE=2 THEN 'B'
ELSE NULL
END	   C6_MAKE_BUY_IND,
	SQ_BCI_PRODUCTS.RETURNABLE_FLAG	   C7_RTRN_DEFECTIVE_FLG,
	SQ_BCI_PRODUCTS.SERVICEABLE_PRODUCT_FLAG	   C8_SALES_SRVC_FLG,
	CASE
WHEN SQ_BCI_PRODUCTS.SERIAL_NUMBER_CONTROL_CODE=1 THEN 'N'
WHEN SQ_BCI_PRODUCTS.SERIAL_NUMBER_CONTROL_CODE=2 THEN 'Y'
WHEN SQ_BCI_PRODUCTS.SERIAL_NUMBER_CONTROL_CODE=5 THEN 'Y'
WHEN SQ_BCI_PRODUCTS.SERIAL_NUMBER_CONTROL_CODE=6 THEN 'Y'
ELSE NULL
END	   C9_SERIALIZED_FLG,
	SQ_BCI_PRODUCTS.SEGMENT1	   C10_PART_NUM,
	SQ_BCI_PRODUCTS.END_DATE_ACTIVE	   C11_DISCONTINUATION_DT,
	TO_CHAR(SQ_BCI_PRODUCTS.HAZARD_CLASS_ID)	   C12_HAZARD_MTL_CODE,
	COALESCE(SQ_BCI_PRODUCTS.PRIMARY_UOM_CODE,'__UNASSIGNED__')	   C13_SALES_UOM_CODE,
	SQ_BCI_PRODUCTS.SHELF_LIFE_DAYS	   C14_SHELF_LIFE,
	COALESCE(SQ_BCI_PRODUCTS.PRIMARY_UOM_CODE,'__UNASSIGNED__')	   C15_BASE_UOM_CODE,
	SQ_BCI_PRODUCTS.UNIT_WEIGHT	   C16_UNIT_GROSS_WEIGHT,
	SQ_BCI_PRODUCTS.UNIT_WEIGHT	   C17_UNIT_NET_WEIGHT,
	SQ_BCI_PRODUCTS.UNIT_VOLUME	   C18_UNIT_VOLUME,
	COALESCE(SQ_BCI_PRODUCTS.VOLUME_UOM_CODE,'__UNASSIGNED__')	   C19_UOV_CODE,
	COALESCE(SQ_BCI_PRODUCTS.WEIGHT_UOM_CODE,'__UNASSIGNED__')	   C20_UOW_CODE,
	SQ_BCI_PRODUCTS.ORDER_COST	   C21_DEALER_INV_PRICE,
	SQ_BCI_PRODUCTS.INVENTORY_ITEM_FLAG	   C22_INVENTORY_FLG,
	SQ_BCI_PRODUCTS.CUSTOMER_ORDER_ENABLED_FLAG	   C23_ORDERABLE_FLG,
	SQ_BCI_PRODUCTS.INVENTORY_ITEM_STATUS_CODE	   C24_STATUS_CODE,
	TO_CHAR(SQ_BCI_PRODUCTS.CREATED_BY)	   C25_CREATED_BY_ID,
	TO_CHAR(SQ_BCI_PRODUCTS.LAST_UPDATED_BY)	   C26_CHANGED_BY_ID,
	SQ_BCI_PRODUCTS.CREATION_DATE	   C27_CREATED_ON_DT,
	SQ_BCI_PRODUCTS.LAST_UPDATE_DATE	   C28_CHANGED_ON_DT,
	TO_CHAR(SQ_BCI_PRODUCTS.INVENTORY_ITEM_ID)	   C29_INTEGRATION_ID,
	SQ_BCI_PRODUCTS.PHASE_CODE	   C30_PRODUCT_PHASE,
	SQ_BCI_PRODUCTS.ITEM_CATALOG_GROUP_ID	   C31_PRODUCT_CLASS,
	SQ_BCI_PRODUCTS.PARENT_CATALOG_GROUP_ID	   C32_PRODUCT_PARENT_CLASS,
	SQ_BCI_PRODUCTS.PROCESS_QUALITY_ENABLED_FLG	   C33_PROCESS_QUALITY_ENABLED_FL,
	SQ_BCI_PRODUCTS.MARKET_PRICE	   C34_MARKET_PRICE,
	SQ_BCI_PRODUCTS.ROUNDING_FACTOR	   C35_ROUNDING_FACTOR,
	SQ_BCI_PRODUCTS.CURRENCY_CODE	   C36_LOC_CURRENCY_CODE,
	SQ_BCI_PRODUCTS.X_ATTRIBUTE1	   C37_X_ATTRIBUTE1,
	SQ_BCI_PRODUCTS.X_ATTRIBUTE2	   C38_X_ATTRIBUTE2,
	SQ_BCI_PRODUCTS.X_ATTRIBUTE3	   C39_X_ATTRIBUTE3,
	SQ_BCI_PRODUCTS.X_ATTRIBUTE4	   C40_X_ATTRIBUTE4,
	SQ_BCI_PRODUCTS.X_ATTRIBUTE5	   C41_X_ATTRIBUTE5,
	SQ_BCI_PRODUCTS.DESCRIPTION	   C42_X_ITEM_DESCR,
	SQ_BCI_PRODUCTS.X_INVENTORY_ITEM_STATUS_CODE	   C43_X_INVENTORY_ITEM_STATUS_CO,
	SQ_BCI_PRODUCTS.ACCOUNTING_RULE	   C44_X_ACCOUNTING_RULE,
	SQ_BCI_PRODUCTS.INVOICING_RULE	   C45_X_INVOICING_RULE,
	SQ_BCI_PRODUCTS.X_ATTRIBUTE11	   C46_X_ATTRIBUTE11
from	
( /* Subselect from SDE_ORA_ProductDimension_Derive.W_ORA_PRODUCT_DS_TMP_SQ_BCI_PRODUCTS
*/


select 
	   

	   
	   MTL_SYSTEM_ITEMS_B.FIXED_ORDER_QUANTITY FIXED_ORDER_QUANTITY,
	MTL_SYSTEM_ITEMS_B.INVENTORY_ITEM_FLAG INVENTORY_ITEM_FLAG,
	MTL_SYSTEM_ITEMS_B.ITEM_TYPE ITEM_TYPE,
	MTL_SYSTEM_ITEMS_B.LAST_UPDATE_DATE LAST_UPDATE_DATE,
	MTL_SYSTEM_ITEMS_B.PURCHASING_ENABLED_FLAG PURCHASING_ENABLED_FLAG,
	MTL_SYSTEM_ITEMS_B.CREATED_BY CREATED_BY,
	MTL_SYSTEM_ITEMS_B.BASE_ITEM_ID BASE_ITEM_ID,
	MTL_SYSTEM_ITEMS_B.PLANNING_MAKE_BUY_CODE PLANNING_MAKE_BUY_CODE,
	MTL_SYSTEM_ITEMS_B.SERIAL_NUMBER_CONTROL_CODE SERIAL_NUMBER_CONTROL_CODE,
	MTL_SYSTEM_ITEMS_B.CUSTOMER_ORDER_ENABLED_FLAG CUSTOMER_ORDER_ENABLED_FLAG,
	MTL_SYSTEM_ITEMS_B.WEIGHT_UOM_CODE WEIGHT_UOM_CODE,
	MTL_SYSTEM_ITEMS_B.SERVICEABLE_PRODUCT_FLAG SERVICEABLE_PRODUCT_FLAG,
	MTL_SYSTEM_ITEMS_B.UNIT_VOLUME UNIT_VOLUME,
	MTL_SYSTEM_ITEMS_B.CREATION_DATE CREATION_DATE,
	MTL_SYSTEM_ITEMS_B.PRIMARY_UOM_CODE PRIMARY_UOM_CODE,
	MTL_SYSTEM_ITEMS_B.ORDER_COST ORDER_COST,
	MTL_SYSTEM_ITEMS_B.SHELF_LIFE_CODE SHELF_LIFE_DAYS,
	MTL_SYSTEM_ITEMS_B.LAST_UPDATED_BY LAST_UPDATED_BY,
	MTL_SYSTEM_ITEMS_B.RETURNABLE_FLAG RETURNABLE_FLAG,
	MTL_SYSTEM_ITEMS_B.INVENTORY_ITEM_ID INVENTORY_ITEM_ID,
	MTL_SYSTEM_ITEMS_B.START_DATE_ACTIVE START_DATE_ACTIVE,
	MTL_SYSTEM_ITEMS_B.HAZARD_CLASS_ID HAZARD_CLASS_ID,
	MTL_PARAMETERS.MASTER_ORGANIZATION_ID MASTER_ORGANIZATION_ID,
	MTL_SYSTEM_ITEMS_B.UNIT_WEIGHT UNIT_WEIGHT,
	MTL_SYSTEM_ITEMS_B.END_DATE_ACTIVE END_DATE_ACTIVE,
	MTL_SYSTEM_ITEMS_B.VOLUME_UOM_CODE VOLUME_UOM_CODE,
	MTL_SYSTEM_ITEMS_B.SEGMENT1 SEGMENT1,
	MTL_SYSTEM_ITEMS_B.DESCRIPTION DESCRIPTION,
	MTL_SYSTEM_ITEMS_B.INVENTORY_ITEM_STATUS_CODE INVENTORY_ITEM_STATUS_CODE,
	TO_CHAR(MTL_SYSTEM_ITEMS_B.CURRENT_PHASE_ID) PHASE_CODE,
	MTL_ITEM_CATALOG_GROUPS_B_KFV.ITEM_CATALOG_GROUP_ID ITEM_CATALOG_GROUP_ID,
	MTL_ITEM_CATALOG_GROUPS_B_KFV.PARENT_CATALOG_GROUP_ID PARENT_CATALOG_GROUP_ID,
	MTL_SYSTEM_ITEMS_B.PROCESS_QUALITY_ENABLED_FLAG PROCESS_QUALITY_ENABLED_FLG,
	MTL_SYSTEM_ITEMS_B.LIST_PRICE_PER_UNIT MARKET_PRICE,
	MTL_SYSTEM_ITEMS_B.ROUNDING_FACTOR ROUNDING_FACTOR,
	GL_LEDGERS.CURRENCY_CODE CURRENCY_CODE,
	MTL_SYSTEM_ITEMS_B.ATTRIBUTE1 X_ATTRIBUTE1,
	MTL_SYSTEM_ITEMS_B.ATTRIBUTE2 X_ATTRIBUTE2,
	MTL_SYSTEM_ITEMS_B.ATTRIBUTE3 X_ATTRIBUTE3,
	MTL_SYSTEM_ITEMS_B.ATTRIBUTE4 X_ATTRIBUTE4,
	MTL_SYSTEM_ITEMS_B.ATTRIBUTE5 X_ATTRIBUTE5,
	MTL_SYSTEM_ITEMS_B.INVENTORY_ITEM_STATUS_CODE X_INVENTORY_ITEM_STATUS_CODE,
	RA_RULES_ACCT.NAME ACCOUNTING_RULE,
	RA_RULES_INV.NAME INVOICING_RULE,
	MTL_SYSTEM_ITEMS_B.ATTRIBUTE11 X_ATTRIBUTE11
from	((((("PC_FIVETRAN_DB"."ERPPRD_INV"."MTL_SYSTEM_ITEMS_B"    MTL_SYSTEM_ITEMS_B LEFT OUTER JOIN 
             "PC_FIVETRAN_DB"."ERPPRD_INV"."MTL_PARAMETERS"    MTL_PARAMETERS ON MTL_SYSTEM_ITEMS_B.ORGANIZATION_ID=MTL_PARAMETERS.ORGANIZATION_ID) 
            LEFT OUTER JOIN "PC_FIVETRAN_DB"."ERPPRD_INV"."MTL_ITEM_CATALOG_GROUPS_B_KFV"   MTL_ITEM_CATALOG_GROUPS_B_KFV
            ON MTL_SYSTEM_ITEMS_B.ITEM_CATALOG_GROUP_ID=MTL_ITEM_CATALOG_GROUPS_B_KFV.ITEM_CATALOG_GROUP_ID) 
           LEFT OUTER JOIN "PC_FIVETRAN_DB"."ERPPRD_HR"."HR_ORGANIZATION_INFORMATION"
    HR_ORGANIZATION_INFORMATION ON MTL_SYSTEM_ITEMS_B.ORGANIZATION_ID=HR_ORGANIZATION_INFORMATION.ORGANIZATION_ID 
           AND HR_ORGANIZATION_INFORMATION.ORG_INFORMATION_CONTEXT='Accounting Information') LEFT OUTER JOIN "PC_FIVETRAN_DB"."ERPPRD_GL"."GL_LEDGERS"
    GL_LEDGERS ON 
          TO_NUMBER(DECODE(RTRIM(TRANSLATE(HR_ORGANIZATION_INFORMATION.ORG_INFORMATION1,'0123456789',' ')),NULL,HR_ORGANIZATION_INFORMATION.ORG_INFORMATION1,-99999)) = GL_LEDGERS.LEDGER_ID 
          AND GL_LEDGERS.OBJECT_TYPE_CODE='L' AND NVL(GL_LEDGERS.COMPLETE_FLAG,'Y')='Y') LEFT OUTER JOIN "PC_FIVETRAN_DB"."ERPPRD_AR"."RA_RULES"
    RA_RULES_ACCT
         ON MTL_SYSTEM_ITEMS_B.ACCOUNTING_RULE_ID=RA_RULES_ACCT.RULE_ID) LEFT OUTER JOIN "PC_FIVETRAN_DB"."ERPPRD_AR"."RA_RULES"
    RA_RULES_INV 
  ON MTL_SYSTEM_ITEMS_B.INVOICING_RULE_ID=RA_RULES_INV.RULE_ID
where	(1=1)

And (MTL_PARAMETERS.MASTER_ORGANIZATION_ID IN ('307'))
 And (
MTL_SYSTEM_ITEMS_B.LAST_UPDATE_DATE>TO_DATE(SUBSTR('2002-01-21 01:39:20',0,19),'YYYY-MM-DD HH24:MI:SS') 
)
 And (MTL_PARAMETERS.MASTER_ORGANIZATION_ID=MTL_PARAMETERS.ORGANIZATION_ID)







)   SQ_BCI_PRODUCTS
where	(1=1)
) ,
 PRODUCT_DS_TMPTOTAL AS
(
select	
	INVENTORY_ITEM_ID,
	ORGANIZATION_ID,
	PRODUCT_TYPE_CODE,
	BASIC_PRODUCT,
	INTRODUCTION_DT,
	MAKE_BUY_IND,
	RTRN_DEFECTIVE_FLG,
	SALES_SRVC_FLG,
	SERIALIZED_FLG,
	PART_NUM,
	DISCONTINUATION_DT,
	HAZARD_MTL_CODE,
	SALES_UOM_CODE,
	SHELF_LIFE,
	BASE_UOM_CODE,
	UNIT_GROSS_WEIGHT,
	UNIT_NET_WEIGHT,
	UNIT_VOLUME,
	UOV_CODE,
	UOW_CODE,
	DEALER_INV_PRICE,
	INVENTORY_FLG,
	ORDERABLE_FLG,
	STATUS_CODE,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	SRC_EFF_FROM_DT,
	DATASOURCE_NUM_ID,
	INTEGRATION_ID,
	PRODUCT_PHASE,
	PRODUCT_CLASS,
	PRODUCT_PARENT_CLASS,
	PROCESS_QUALITY_ENABLED_FLG,
	MARKET_PRICE,
	ROUNDING_FACTOR,
	LOC_CURRENCY_CODE,
	X_ATTRIBUTE1,
	X_ATTRIBUTE2,
	X_ATTRIBUTE3,
	X_ATTRIBUTE4,
	X_ATTRIBUTE5,
	X_ITEM_DESCR,
	X_INVENTORY_ITEM_STATUS_CODE,
	X_ACCOUNTING_RULE,
	X_INVOICING_RULE,
	X_ATTRIBUTE11
	,'N' SALES_PROD_FLG,
	TO_DATE(SUBSTR('3714-01-01 00:00:00',0,19),'YYYY-MM-DD HH24:MI:SS') SRC_EFF_TO_DT,
	'N' DELETE_FLG,
	'DEFAULT' TENANT_ID,
	'0' X_CUSTOM,
	141840 ETL_PROC_WID,
	CURRENT_DATE W_INSERT_DT

	 
FROM (	


select 	
	
	C1_INVENTORY_ITEM_ID INVENTORY_ITEM_ID,
	C2_ORGANIZATION_ID ORGANIZATION_ID,
	C3_PRODUCT_TYPE_CODE PRODUCT_TYPE_CODE,
	C4_BASIC_PRODUCT BASIC_PRODUCT,
	C5_INTRODUCTION_DT INTRODUCTION_DT,
	C6_MAKE_BUY_IND MAKE_BUY_IND,
	C7_RTRN_DEFECTIVE_FLG RTRN_DEFECTIVE_FLG,
	C8_SALES_SRVC_FLG SALES_SRVC_FLG,
	C9_SERIALIZED_FLG SERIALIZED_FLG,
	C10_PART_NUM PART_NUM,
	C11_DISCONTINUATION_DT DISCONTINUATION_DT,
	C12_HAZARD_MTL_CODE HAZARD_MTL_CODE,
	C13_SALES_UOM_CODE SALES_UOM_CODE,
	C14_SHELF_LIFE SHELF_LIFE,
	C15_BASE_UOM_CODE BASE_UOM_CODE,
	C16_UNIT_GROSS_WEIGHT UNIT_GROSS_WEIGHT,
	C17_UNIT_NET_WEIGHT UNIT_NET_WEIGHT,
	C18_UNIT_VOLUME UNIT_VOLUME,
	C19_UOV_CODE UOV_CODE,
	C20_UOW_CODE UOW_CODE,
	C21_DEALER_INV_PRICE DEALER_INV_PRICE,
	C22_INVENTORY_FLG INVENTORY_FLG,
	C23_ORDERABLE_FLG ORDERABLE_FLG,
	C24_STATUS_CODE STATUS_CODE,
	C25_CREATED_BY_ID CREATED_BY_ID,
	C26_CHANGED_BY_ID CHANGED_BY_ID,
	C27_CREATED_ON_DT CREATED_ON_DT,
	C28_CHANGED_ON_DT CHANGED_ON_DT,
	TO_DATE(SUBSTR('1899-01-01 00:00:00',0,19),'YYYY-MM-DD HH24:MI:SS') SRC_EFF_FROM_DT,
	380 DATASOURCE_NUM_ID,
	C29_INTEGRATION_ID INTEGRATION_ID,
	C30_PRODUCT_PHASE PRODUCT_PHASE,
	C31_PRODUCT_CLASS PRODUCT_CLASS,
	C32_PRODUCT_PARENT_CLASS PRODUCT_PARENT_CLASS,
	C33_PROCESS_QUALITY_ENABLED_FL PROCESS_QUALITY_ENABLED_FLG,
	C34_MARKET_PRICE MARKET_PRICE,
	C35_ROUNDING_FACTOR ROUNDING_FACTOR,
	C36_LOC_CURRENCY_CODE LOC_CURRENCY_CODE,
	C37_X_ATTRIBUTE1 X_ATTRIBUTE1,
	C38_X_ATTRIBUTE2 X_ATTRIBUTE2,
	C39_X_ATTRIBUTE3 X_ATTRIBUTE3,
	C40_X_ATTRIBUTE4 X_ATTRIBUTE4,
	C41_X_ATTRIBUTE5 X_ATTRIBUTE5,
	C42_X_ITEM_DESCR X_ITEM_DESCR,
	C43_X_INVENTORY_ITEM_STATUS_CO X_INVENTORY_ITEM_STATUS_CODE,
	C44_X_ACCOUNTING_RULE X_ACCOUNTING_RULE,
	C45_X_INVOICING_RULE X_INVOICING_RULE,
	C46_X_ATTRIBUTE11 X_ATTRIBUTE11 
from	PRODUCT_DS_TMP
where		(1=1)	






)    ODI_GET_FROM

)
SELECT * FROM PRODUCT_DS_TMPTOTAL