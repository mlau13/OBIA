WITH CONTACT AS(

select	
	
	SQ_WC_CONTACTS_D.CONTACT_ID	   C1_CONTACT_ID,
	TO_CHAR(SQ_WC_CONTACTS_D.CUSTOMER_ID)	   C2_CUSTOMER_ID,
	SQ_WC_CONTACTS_D.ADDRESS_ID	   C3_ADDRESS_ID,
	SQ_WC_CONTACTS_D.LAST_UPDATE_DATE	   C4_LAST_UPDATE_DATE,
	SQ_WC_CONTACTS_D.OBJECT_VERSION	   C5_OBJECT_VERSION,
	SQ_WC_CONTACTS_D.LAST_UPDATED_BY	   C6_LAST_UPDATED_BY,
	SQ_WC_CONTACTS_D.CREATION_DATE	   C7_CREATION_DATE,
	SQ_WC_CONTACTS_D.CREATED_BY	   C8_CREATED_BY,
	SQ_WC_CONTACTS_D.LAST_UPDATE_LOGIN	   C9_LAST_UPDATE_LOGIN,
	SQ_WC_CONTACTS_D.FIRST_NAME	   C10_FIRST_NAME,
	SQ_WC_CONTACTS_D.LAST_NAME	   C11_LAST_NAME,
	SQ_WC_CONTACTS_D.STATUS	   C12_STATUS,
	SQ_WC_CONTACTS_D.MAIL_STOP	   C13_MAIL_STOP,
	SQ_WC_CONTACTS_D.ORIG_SYSTEM_REFERENCE	   C14_ORIG_SYSTEM_REFERENCE,
	SQ_WC_CONTACTS_D.CONTACT_KEY	   C15_CONTACT_KEY,
	SQ_WC_CONTACTS_D.EMAIL_ADDRESS	   C16_EMAIL_ADDRESS,
	SQ_WC_CONTACTS_D.CONTACT_PARTY_ID	   C17_CONTACT_PARTY_ID,
	SQ_WC_CONTACTS_D.ORG_CONTACT_ID	   C18_ORG_CONTACT_ID,
	SQ_WC_CONTACTS_D.CONTACT_NUMBER	   C19_CONTACT_NUMBER,
	SQ_WC_CONTACTS_D.CONT_POINT_OBJECT_VERSION	   C20_CONT_POINT_OBJECT_VERSION,
	SQ_WC_CONTACTS_D.PARTY_LAST_UPDATE_DATE	   C21_PARTY_LAST_UPDATE_DATE,
	SQ_WC_CONTACTS_D.PARTY_OBJECT_VERSION_NUMBER	   C22_PARTY_OBJECT_VERSION,
	SQ_WC_CONTACTS_D.REL_LAST_UPDATE_DATE	   C23_REL_LAST_UPDATE_DATE,
	SQ_WC_CONTACTS_D.ORG_CONT_LAST_UPDATE_DATE	   C24_ORG_CONT_LAST_UPDATE_DATE,
	SQ_WC_CONTACTS_D.ORG_OBJ_VERSION_NUMBER	   C25_ORG_CONT_OBJECT_VERSION,
	SQ_WC_CONTACTS_D.REL_RELATIONSHIP_ID	   C26_PARTY_RELATIONSHIP_ID,
	SQ_WC_CONTACTS_D.REL_PARTY_LAST_UPDATE_DATE	   C27_REL_PARTY_LAST_UPDATE_DATE,
	SQ_WC_CONTACTS_D.REL_OBJECT_VERSION_NUMBER	   C28_REL_PARTY_OBJECT_VERSION,
	SQ_WC_CONTACTS_D.REL_PARTY_ID	   C29_REL_PARTY_ID,
	SQ_WC_CONTACTS_D.REL_OBJECT_VERSION_NUMBER	   C30_RELATION_OBJECT_VERSION,
	SQ_WC_CONTACTS_D.CONTACT_ID	   C31_INTEGRATION_ID,
	SQ_WC_CONTACTS_D.PHONE_NUMBER	   C32_PHONE_NUMBER
from	
( /* Subselect from WR_SDE_ORA_ContactDimension.SQ_WC_CONTACT_DS_CONTACT_DS
*/


select 
	   

	   DISTINCT
	   ACCT_ROLE.CUST_ACCOUNT_ROLE_ID CONTACT_ID,
	ACCT_ROLE.CUST_ACCOUNT_ID CUSTOMER_ID,
	ACCT_ROLE.CUST_ACCT_SITE_ID ADDRESS_ID,
	ACCT_ROLE.LAST_UPDATE_DATE LAST_UPDATE_DATE,
	ACCT_ROLE.OBJECT_VERSION_NUMBER OBJECT_VERSION,
	ACCT_ROLE.LAST_UPDATED_BY LAST_UPDATED_BY,
	ACCT_ROLE.CREATION_DATE CREATION_DATE,
	ACCT_ROLE.CREATED_BY CREATED_BY,
	ACCT_ROLE.LAST_UPDATE_LOGIN LAST_UPDATE_LOGIN,
	PARTY.PERSON_FIRST_NAME FIRST_NAME,
	PARTY.PERSON_LAST_NAME LAST_NAME,
	ACCT_ROLE.STATUS STATUS,
	ORG_CONT.MAIL_STOP MAIL_STOP,
	ACCT_ROLE.ORIG_SYSTEM_REFERENCE ORIG_SYSTEM_REFERENCE,
	PARTY.CUSTOMER_KEY CONTACT_KEY,
	REL_PARTY.EMAIL_ADDRESS EMAIL_ADDRESS,
	REL_PARTY.PRIMARY_PHONE_AREA_CODE||REL_PARTY.PRIMARY_PHONE_NUMBER PHONE_NUMBER,
	REL_PARTY.PARTY_ID CONTACT_PARTY_ID,
	ORG_CONT.ORG_CONTACT_ID ORG_CONTACT_ID,
	ORG_CONT.CONTACT_NUMBER CONTACT_NUMBER,
	PARTY.LAST_UPDATE_DATE PARTY_LAST_UPDATE_DATE,
	PARTY.OBJECT_VERSION_NUMBER PARTY_OBJECT_VERSION_NUMBER,
	REL.LAST_UPDATE_DATE REL_LAST_UPDATE_DATE,
	ORG_CONT.LAST_UPDATE_DATE ORG_CONT_LAST_UPDATE_DATE,
	ORG_CONT.OBJECT_VERSION_NUMBER ORG_OBJ_VERSION_NUMBER,
	REL.RELATIONSHIP_ID REL_RELATIONSHIP_ID,
	REL_PARTY.LAST_UPDATE_DATE REL_PARTY_LAST_UPDATE_DATE,
	REL_PARTY.PARTY_ID REL_PARTY_ID,
	REL.OBJECT_VERSION_NUMBER REL_OBJECT_VERSION_NUMBER,
	CONT_POINT.OBJECT_VERSION_NUMBER CONT_POINT_OBJECT_VERSION
from	"PC_FIVETRAN_DB"."EBSUAT_AR"."HZ_CONTACT_POINTS"
   CONT_POINT, 
  "PC_FIVETRAN_DB"."EBSUAT_AR"."HZ_CUST_ACCOUNT_ROLES" ACCT_ROLE, 
  "PC_FIVETRAN_DB"."EBSUAT_AR"."HZ_PARTIES"
   PARTY, "PC_FIVETRAN_DB"."EBSUAT_AR"."HZ_PARTIES"   REL_PARTY, 
  "PC_FIVETRAN_DB"."EBSUAT_AR"."HZ_RELATIONSHIPS" REL, 
  "PC_FIVETRAN_DB"."EBSUAT_AR"."HZ_ORG_CONTACTS" ORG_CONT, 
 "PC_FIVETRAN_DB"."EBSUAT_AR"."HZ_CUST_ACCOUNTS" ROLE_ACCT, 
  "PC_FIVETRAN_DB"."ERPUAT_AR"."HZ_PERSON_LANGUAGE"   PER_LANG, 
  "PC_FIVETRAN_DB"."ERPUAT_AR"."HZ_CONTACT_PREFERENCES" CONT_RES
where	(1=1)
 And (PARTY.PARTY_ID = CONT_RES.CONTACT_PREFERENCE_ID(+))
AND (ACCT_ROLE.PARTY_ID = REL.PARTY_ID
 AND ACCT_ROLE.ROLE_TYPE = 'CONTACT')
AND (ORG_CONT.PARTY_RELATIONSHIP_ID = REL.RELATIONSHIP_ID)
AND (REL.SUBJECT_ID = PARTY.PARTY_ID)
AND (REL_PARTY.PARTY_ID = REL.PARTY_ID)
AND (CONT_POINT.OWNER_TABLE_ID(+) = REL_PARTY.PARTY_ID)
AND (ACCT_ROLE.CUST_ACCOUNT_ID = ROLE_ACCT.CUST_ACCOUNT_ID)
AND (ROLE_ACCT.PARTY_ID = REL.OBJECT_ID)
AND (PARTY.PARTY_ID = PER_LANG.PARTY_ID(+))

And (CONT_RES.CONTACT_LEVEL_TABLE(+) = 'HZ_PARTIES')
 And (CONT_POINT.CONTACT_POINT_TYPE(+)='EMAIL')
 And (CONT_POINT.PRIMARY_FLAG(+)='Y')
 And (PER_LANG.NATIVE_LANGUAGE(+) = 'Y')
 And (CONT_POINT.OWNER_TABLE_NAME(+) = 'HZ_PARTIES')







)   SQ_WC_CONTACTS_D
where	(1=1)
),

CONTACTTOTAL AS
(
    	select	
	CONTACT_ID,
	CUSTOMER_ID,
	ADDRESS_ID,
	LAST_UPDATE_DATE,
	OBJECT_VERSION,
	LAST_UPDATED_BY,
	CREATION_DATE,
	CREATED_BY,
	LAST_UPDATE_LOGIN,
	FIRST_NAME,
	LAST_NAME,
	STATUS,
	MAIL_STOP,
	ORIG_SYSTEM_REFERENCE,
	CONTACT_KEY,
	EMAIL_ADDRESS,
	CONTACT_PARTY_ID,
	ORG_CONTACT_ID,
	CONTACT_NUMBER,
	CONT_POINT_OBJECT_VERSION,
	PARTY_LAST_UPDATE_DATE,
	PARTY_OBJECT_VERSION,
	REL_LAST_UPDATE_DATE,
	ORG_CONT_LAST_UPDATE_DATE,
	ORG_CONT_OBJECT_VERSION,
	PARTY_RELATIONSHIP_ID,
	REL_PARTY_LAST_UPDATE_DATE,
	REL_PARTY_OBJECT_VERSION,
	REL_PARTY_ID,
	RELATION_OBJECT_VERSION,
	INTEGRATION_ID,
	PHONE_NUMBER,
	380 DATASOURCE_NUM_ID
FROM (	


select 	
	
	C1_CONTACT_ID CONTACT_ID,
	C2_CUSTOMER_ID CUSTOMER_ID,
	C3_ADDRESS_ID ADDRESS_ID,
	C4_LAST_UPDATE_DATE LAST_UPDATE_DATE,
	C5_OBJECT_VERSION OBJECT_VERSION,
	C6_LAST_UPDATED_BY LAST_UPDATED_BY,
	C7_CREATION_DATE CREATION_DATE,
	C8_CREATED_BY CREATED_BY,
	C9_LAST_UPDATE_LOGIN LAST_UPDATE_LOGIN,
	C10_FIRST_NAME FIRST_NAME,
	C11_LAST_NAME LAST_NAME,
	C12_STATUS STATUS,
	C13_MAIL_STOP MAIL_STOP,
	C14_ORIG_SYSTEM_REFERENCE ORIG_SYSTEM_REFERENCE,
	C15_CONTACT_KEY CONTACT_KEY,
	C16_EMAIL_ADDRESS EMAIL_ADDRESS,
	C17_CONTACT_PARTY_ID CONTACT_PARTY_ID,
	C18_ORG_CONTACT_ID ORG_CONTACT_ID,
	C19_CONTACT_NUMBER CONTACT_NUMBER,
	C20_CONT_POINT_OBJECT_VERSION CONT_POINT_OBJECT_VERSION,
	C21_PARTY_LAST_UPDATE_DATE PARTY_LAST_UPDATE_DATE,
	C22_PARTY_OBJECT_VERSION PARTY_OBJECT_VERSION,
	C23_REL_LAST_UPDATE_DATE REL_LAST_UPDATE_DATE,
	C24_ORG_CONT_LAST_UPDATE_DATE ORG_CONT_LAST_UPDATE_DATE,
	C25_ORG_CONT_OBJECT_VERSION ORG_CONT_OBJECT_VERSION,
	C26_PARTY_RELATIONSHIP_ID PARTY_RELATIONSHIP_ID,
	C27_REL_PARTY_LAST_UPDATE_DATE REL_PARTY_LAST_UPDATE_DATE,
	C28_REL_PARTY_OBJECT_VERSION REL_PARTY_OBJECT_VERSION,
	C29_REL_PARTY_ID REL_PARTY_ID,
	C30_RELATION_OBJECT_VERSION RELATION_OBJECT_VERSION,
	C31_INTEGRATION_ID INTEGRATION_ID,
	C32_PHONE_NUMBER PHONE_NUMBER 
from	CONTACT
where		(1=1)	






)    ODI_GET_FROM
)

SELECT * FROM CONTACTTOTAL