{{ config (
    materialized="table"
)}}

WITH GL_LEDGERS AS
(
select	
	
	SQ_GL_LEDGERS.NAME	   C1_LEDGER_NAME,
	SQ_GL_LEDGERS.SHORT_NAME	   C2_LEDGER_SHORT_NAME,
	SQ_GL_LEDGERS.DESCRIPTION	   C3_LEDGER_DESC,
	TO_CHAR(SQ_GL_LEDGERS.CHART_OF_ACCOUNTS_ID)	   C4_CHART_OF_ACCOUNTS,
	COALESCE(SQ_GL_LEDGERS.CURRENCY_CODE,'__UNASSIGNED__')	   C5_CURRENCY_CODE,
	SQ_GL_LEDGERS.PERIOD_SET_NAME	   C6_CALENDER_NAME,
	COALESCE(SQ_GL_LEDGERS.SLA_ACCOUNTING_METHOD_CODE,'__UNASSIGNED__')	   C7_SLA_ACCOUNTING_METHOD_CODE,
	SQ_GL_LEDGERS.USER_PERIOD_TYPE	   C8_PERIOD_TYPE,
	COALESCE(SQ_GL_LEDGERS.LEDGER_CATEGORY_CODE,'__UNASSIGNED__')	   C9_LEDGER_CATEGORY_CODE,
	TO_CHAR(SQ_GL_LEDGERS.CREATED_BY)	   C10_CREATED_BY_ID,
	TO_CHAR(SQ_GL_LEDGERS.LAST_UPDATED_BY)	   C11_CHANGED_BY_ID,
	SQ_GL_LEDGERS.CREATION_DATE	   C12_CREATED_ON_DT,
	SQ_GL_LEDGERS.LAST_UPDATE_DATE	   C13_CHANGED_ON_DT,
	TO_CHAR(SQ_GL_LEDGERS.LEDGER_ID)	   C14_INTEGRATION_ID
from	
( /* Subselect from SDE_ORA_LedgerDimension.W_LEDGER_DS_SQ_GL_LEDGERS
*/


select 
	   

	   
	   GL_LEDGERS.LEDGER_ID LEDGER_ID,
	GL_LEDGERS.NAME NAME,
	GL_LEDGERS.SHORT_NAME SHORT_NAME,
	GL_LEDGERS.DESCRIPTION DESCRIPTION,
	GL_LEDGERS.LEDGER_CATEGORY_CODE LEDGER_CATEGORY_CODE,
	GL_LEDGERS.CHART_OF_ACCOUNTS_ID CHART_OF_ACCOUNTS_ID,
	GL_LEDGERS.CURRENCY_CODE CURRENCY_CODE,
	GL_LEDGERS.PERIOD_SET_NAME PERIOD_SET_NAME,
	GL_LEDGERS.SLA_ACCOUNTING_METHOD_CODE SLA_ACCOUNTING_METHOD_CODE,
	GL_LEDGERS.LAST_UPDATE_DATE LAST_UPDATE_DATE,
	GL_LEDGERS.LAST_UPDATED_BY LAST_UPDATED_BY,
	GL_LEDGERS.CREATION_DATE CREATION_DATE,
	GL_LEDGERS.CREATED_BY CREATED_BY,
	XLA_ACCTG_METHODS_TL.NAME SLA_ACCOUNTING_METHOD_NAME,
	GL_PERIOD_TYPES.USER_PERIOD_TYPE USER_PERIOD_TYPE
from	"PC_FIVETRAN_DB"."ERPPRD_XLA"."XLA_ACCTG_METHODS_TL"
   XLA_ACCTG_METHODS_TL, "PC_FIVETRAN_DB"."ERPPRD_GL"."GL_LEDGERS"
   GL_LEDGERS, "PC_FIVETRAN_DB"."ERPPRD_GL"."GL_PERIOD_TYPES"
   GL_PERIOD_TYPES
where	(1=1)
 And (GL_LEDGERS.SLA_ACCOUNTING_METHOD_CODE=XLA_ACCTG_METHODS_TL.ACCOUNTING_METHOD_CODE(+))
AND (GL_LEDGERS.SLA_ACCOUNTING_METHOD_TYPE=XLA_ACCTG_METHODS_TL.ACCOUNTING_METHOD_TYPE_CODE(+))
AND (GL_LEDGERS.ACCOUNTED_PERIOD_TYPE=GL_PERIOD_TYPES.PERIOD_TYPE)

And (NVL(GL_LEDGERS.COMPLETE_FLAG,'Y')='Y')
 And (GL_LEDGERS.OBJECT_TYPE_CODE='L')
 And (XLA_ACCTG_METHODS_TL.LANGUAGE(+)= 'US')







)   SQ_GL_LEDGERS
where	(1=1)
),

GL_LEDGERSTOTAL AS
(
select	
	LEDGER_NAME,
	LEDGER_SHORT_NAME,
	LEDGER_DESC,
	CHART_OF_ACCOUNTS,
	CURRENCY_CODE,
	CALENDER_NAME,
	SLA_ACCOUNTING_METHOD_CODE,
	PERIOD_TYPE,
	LEDGER_CATEGORY_CODE,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	DATASOURCE_NUM_ID,
	INTEGRATION_ID,
	to_varchar(CURRENT_TIMESTAMP, 'yyyy-MM-DD hh:mi:ss') LAST_DATE
FROM (	


select 	
	
	C1_LEDGER_NAME LEDGER_NAME,
	C2_LEDGER_SHORT_NAME LEDGER_SHORT_NAME,
	C3_LEDGER_DESC LEDGER_DESC,
	C4_CHART_OF_ACCOUNTS CHART_OF_ACCOUNTS,
	C5_CURRENCY_CODE CURRENCY_CODE,
	C6_CALENDER_NAME CALENDER_NAME,
	C7_SLA_ACCOUNTING_METHOD_CODE SLA_ACCOUNTING_METHOD_CODE,
	C8_PERIOD_TYPE PERIOD_TYPE,
	C9_LEDGER_CATEGORY_CODE LEDGER_CATEGORY_CODE,
	C10_CREATED_BY_ID CREATED_BY_ID,
	C11_CHANGED_BY_ID CHANGED_BY_ID,
	C12_CREATED_ON_DT CREATED_ON_DT,
	C13_CHANGED_ON_DT CHANGED_ON_DT,
	380 DATASOURCE_NUM_ID,
	C14_INTEGRATION_ID INTEGRATION_ID 
from	GL_LEDGERS
where		(1=1)	






)    ODI_GET_FROM

)

SELECT * FROM GL_LEDGERSTOTAL


