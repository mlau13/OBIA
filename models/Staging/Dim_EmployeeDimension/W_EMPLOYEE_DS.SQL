{{ config (
    materialized="table"
)}}

with EMP as (

    select * from {{ ref('W_EMPLOYEE_DS_EMP')}}

),

NONEMP as (

    select * from {{ ref('W_EMPLOYEE_DS_NONEMP') }}

),


 W_EMPLOYEE_DS as (

   select 
FST_NAME	,
MID_NAME	,
LAST_NAME	,
PREV_LAST_NAME	,
FULL_NAME	,
NAME_PREFIX	,
INDV_TITLE	,
NAME_SUFFIX	,
PARTY_ID	,
EMAIL_ADDR	,
EMP_HIRE_DT	,
ORIG_HIRE_DT	,
ADJ_SERVICE_DT	,
CONTRACT_ST_DT	,
CONTRACT_END_DT	,
EMPLOYEE_NUM	,
SUPERVISOR_NUM	,
SUPERVISOR_NAME	,
CONTINGENT_WORKER_NUM	,
APPLICANT_NUM	,
DEPARTMENT_CODE	,
C22_HELD_POSTN	,
POSITION_TYPE_CODE	,
JOB_TITLE	,
PAR_HELD_POSTN	,
PR_POSTN	,
EMP_FLG	,
SALES_REP_FLG	,
BUYER_FLG	,
REQUESTOR_FLG	,
APPLICANT_FLG	,
MANAGER_FLG	,
LOGIN	,
SRC_EFF_FROM_DT	,
SRC_EFF_TO_DT	,
INTEGRATION_ID	,
X_CUSTOM	,
DELETE_FLG	,
PAR_INTEGRATION_ID	,
VIS_PR_BU_ID	,
VIS_PR_POS_ID	,
CREATED_BY_ID	,
CHANGED_BY_ID	,
CREATED_ON_DT	,
CHANGED_ON_DT	,
AUX1_CHANGED_ON_DT	,
AUX2_CHANGED_ON_DT	,
AUX3_CHANGED_ON_DT	,
LAST_WORKED_DT	,
REQUESTOR_ID	,
BUYER_ID	,
AUX6_CHANGED_ON_DT	,
X_SALESREP_NUMBER	,
PERSON_ID	,
NULL	SOURCE_ADDRESS1	,
NULL	SOURCE_ADDRESS2	,
NULL	SOURCE_ADDRESS3	,
NULL	SOURCE_ADDRESS4	,
NULL	CITY	,
NULL	COUNTY	,
NULL	STATE_PROV_CODE	,
NULL	ZIPCODE	,
NULL	WORK_PHONE	,
NULL	PAGER_NUM	,
NULL	MOBILE_NUM	,
NULL	NATIVE_LANG_CODE	,
NULL	SEC_FLU_LANG_CODE
  from EMP
UNION ALL
   select 
  FST_NAME	FST_NAME	,
MID_NAME	MID_NAME	,
LAST_NAME	LAST_NAME	,
NULL	PREV_LAST_NAME	,
FULL_NAME	FULL_NAME	,
NULL	NAME_PREFIX	,
NULL	INDV_TITLE	,
NULL	NAME_SUFFIX	,
PARTY_ID	PARTY_ID	,
EMAIL_ADDR	EMAIL_ADDR	,
NULL	EMP_HIRE_DT	,
NULL	ORIG_HIRE_DT	,
NULL	ADJ_SERVICE_DT	,
NULL	CONTRACT_ST_DT	,
NULL	CONTRACT_END_DT	,
EMPLOYEE_NUM	EMPLOYEE_NUM	,
NULL	SUPERVISOR_NUM	,
NULL	SUPERVISOR_NAME	,
NULL	CONTINGENT_WORKER_NUM	,
NULL	APPLICANT_NUM	,
NULL	DEPARTMENT_CODE	,
NULL	C22_HELD_POSTN	,
NULL	POSITION_TYPE_CODE	,
JOB_TITLE	JOB_TITLE	,
NULL	PAR_HELD_POSTN	,
NULL	PR_POSTN	,
NULL	EMP_FLG	,
SALES_REP_FLG	SALES_REP_FLG	,
NULL	BUYER_FLG	,
NULL	REQUESTOR_FLG	,
NULL	APPLICANT_FLG	,
NULL	MANAGER_FLG	,
LOGIN	LOGIN	,
NULL	SRC_EFF_FROM_DT	,
NULL	SRC_EFF_TO_DT	,
INTEGRATION_ID	INTEGRATION_ID	,
NULL	X_CUSTOM	,
DELETE_FLG	DELETE_FLG	,
NULL	PAR_INTEGRATION_ID	,
NULL	VIS_PR_BU_ID	,
NULL	VIS_PR_POS_ID	,
NULL	CREATED_BY_ID	,
NULL	CHANGED_BY_ID	,
NULL	CREATED_ON_DT	,
CHANGED_ON_DT	CHANGED_ON_DT	,
NULL	AUX1_CHANGED_ON_DT	,
NULL	AUX2_CHANGED_ON_DT	,
NULL	AUX3_CHANGED_ON_DT	,
NULL	LAST_WORKED_DT	,
NULL	REQUESTOR_ID	,
NULL	BUYER_ID	,
NULL	AUX6_CHANGED_ON_DT	,
NULL	X_SALESREP_NUMBER	,
NULL	PERSON_ID	,
SOURCE_ADDRESS1	,
SOURCE_ADDRESS2	,
SOURCE_ADDRESS3	,
SOURCE_ADDRESS4	,
CITY	,
COUNTY	,
STATE_PROV_CODE	,
ZIPCODE	,
WORK_PHONE	,
PAGER_NUM	,
MOBILE_NUM	,
NATIVE_LANG_CODE	,
SEC_FLU_LANG_CODE	
from NONEMP
)


SELECT * FROM W_EMPLOYEE_DS