{{ config (
    materialized="table"
)}}


select	
	
	TO_CHAR(SQ_FND_FLEX_VALUES.FLEX_VALUE_SET_ID)	  SEGMENT_LOV_ID,
	COALESCE(SQ_FND_FLEX_VALUES.FLEX_VALUE,'__UNASSIGNED__')	  EGMENT_VAL_CODE,
	TO_CHAR(SQ_FND_FLEX_VALUES.CREATED_BY)	   CREATED_BY_ID,
	TO_CHAR(SQ_FND_FLEX_VALUES.LAST_UPDATED_BY)	  CHANGED_BY_ID,
	SQ_FND_FLEX_VALUES.CREATION_DATE	   CREATED_ON_DT,
	SQ_FND_FLEX_VALUES.CHANGED_ON_DT	   CHANGED_ON_DT,
	SQ_FND_FLEX_VALUES.LAST_UPDATE_DATE1	  AUX1_CHANGED_ON_DT,
	TO_DATE('01/01/1899 00:00:00', 'MM/DD/YYYY HH24:MI:SS')	  SRC_EFF_FROM_DT,
	TO_DATE('01/01/3714 00:00:00', 'MM/DD/YYYY HH24:MI:SS')	  SRC_EFF_TO_DT,
	SQ_FND_FLEX_VALUES.DELETE_FLG	   DELETE_FLG,
	TO_CHAR(SQ_FND_FLEX_VALUES.FLEX_VALUE_SET_ID) || '~' || SQ_FND_FLEX_VALUES.FLEX_VALUE	   INTEGRATION_ID
from	
( /* Subselect from SDE_ORA_GLSegmentDimension.W_GL_SEGMENT_DS_SQ_FND_FLEX_VALUES
*/


select 
	   

	   
	   FND_FLEX_VALUE_SETS.FLEX_VALUE_SET_ID FLEX_VALUE_SET_ID,
	CASE WHEN FND_FLEX_VALUE_SETS.VALIDATION_TYPE='I' THEN
FND_FLEX_VALUES.FLEX_VALUE
ELSE FND_FLEX_VALUES.FLEX_VALUE||'~'||FND_FLEX_VALUES.PARENT_FLEX_VALUE_LOW
END FLEX_VALUE,
	FND_FLEX_VALUES.LAST_UPDATE_DATE LAST_UPDATE_DATE,
	FND_FLEX_VALUES.LAST_UPDATED_BY LAST_UPDATED_BY,
	FND_FLEX_VALUES.CREATION_DATE CREATION_DATE,
	FND_FLEX_VALUES.CREATED_BY CREATED_BY,
	FND_FLEX_VALUES.START_DATE_ACTIVE START_DATE_ACTIVE,
	FND_FLEX_VALUES.END_DATE_ACTIVE END_DATE_ACTIVE,
	FND_FLEX_VALUE_SETS.LAST_UPDATE_DATE LAST_UPDATE_DATE1,
	
 FND_FLEX_VALUES.LAST_UPDATE_DATE
 CHANGED_ON_DT,
	
 'N'
 DELETE_FLG
from	"PC_FIVETRAN_DB"."ERPPRD_APPLSYS"."FND_FLEX_VALUES"    FND_FLEX_VALUES INNER JOIN "PC_FIVETRAN_DB"."ERPPRD_APPLSYS"."FND_FLEX_VALUE_SETS"    FND_FLEX_VALUE_SETS ON FND_FLEX_VALUES.FLEX_VALUE_SET_ID=FND_FLEX_VALUE_SETS.FLEX_VALUE_SET_ID
where	(1=1)

And (

(FND_FLEX_VALUES.LAST_UPDATE_DATE > TO_DATE(SUBSTR('2002-01-23 11:54:44',0,19),'YYYY-MM-DD HH24:MI:SS') or FND_FLEX_VALUE_SETS.LAST_UPDATE_DATE > TO_DATE(SUBSTR('2002-01-23 11:54:44',0,19),'YYYY-MM-DD HH24:MI:SS'))

)
 And (FND_FLEX_VALUE_SETS.VALIDATION_TYPE IN ('I','D'))







)   SQ_FND_FLEX_VALUES
where	(1=1)











 

